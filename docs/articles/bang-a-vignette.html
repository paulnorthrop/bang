<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introducing bang: Bayesian Analysis, No Gibbs • bang</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introducing bang: Bayesian Analysis, No Gibbs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bang</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bang-a-vignette.html">Introducing bang: Bayesian Analysis, No Gibbs</a>
    </li>
    <li>
      <a href="../articles/bang-b-hef-vignette.html">Conjugate Hierarchical Models</a>
    </li>
    <li>
      <a href="../articles/bang-c-anova-vignette.html">Hierarchical 1-way Analysis of Variance</a>
    </li>
    <li>
      <a href="../articles/bang-d-ppc-vignette.html">Posterior Predictive Checking</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/bang">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introducing bang: Bayesian Analysis, No Gibbs</h1>
                        <h4 class="author">Paul Northrop</h4>
            
            <h4 class="date">2020-02-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/bang/blob/master/vignettes/bang-a-vignette.Rmd"><code>vignettes/bang-a-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>bang-a-vignette.Rmd</code></div>

    </div>

    
    
<p>The <em>bang</em> package uses the <em>rust</em> package <span class="citation">(Northrop 2017b)</span> to produce random samples, using the generalized ratio-of-uniforms method, from the posterior distributions involved in certain Bayesian models. <em>rust</em> was originally created to perform this role in the package <em>revdbayes</em> <span class="citation">(Northrop 2017a)</span>, which deals with basic extreme value models with only 2 or 3 parameters. The aim of <em>bang</em> is to tackle further models.</p>
<p>See also the vignettes <a href="bang-anova-vignette.html">Hierarchical 1-way Analysis of Variance</a> and <a href="bang-hef-vignette.html">Conjugate Hierarchical Models</a>.</p>
<div id="the-generalized-ratio-of-uniforms-method-as-an-alternative-to-mcmc" class="section level2">
<h2 class="hasAnchor">
<a href="#the-generalized-ratio-of-uniforms-method-as-an-alternative-to-mcmc" class="anchor"></a>The generalized ratio-of-uniforms method as an alternative to MCMC</h2>
<p>The ratio-of-uniforms method is an acceptance-rejection type algorithm whose efficiency decreases quickly as the dimension of the target distribution increases. Therefore, it may not be a feasible method of sampling directly from a distribution with the order of 10 parameters. However, for some models it is possible to factorize the joint posterior density into a product of a marginal posterior density for a low-dimensional set of parameters and conditional posteriors densities of the other parameters given the parameters in this set. In such cases we can sample values from the marginal posterior and then sample from the conditional posteriors given these values. The examples considered in the first release of <em>bang</em> are hierarchical models in which the marginal density is not of a simple form (so we use <em>rust</em> to sample from it) but the conditional densities are of a simple form and we can simulate from them using standard simulation algorithms.</p>
<p>In comparison to sampling from a posterior distribution using a Markov Chain Monte Carlo (MCMC) method, such as Gibbs sampling, direct simulation to produce a random sample has some advantages: no need to monitor convergence, no serial dependence in the sample. However, the generalized ratio-of-uniforms method can only be applied to densities for which its acceptance region can be enclosed within a bounding region of finite volume from which it is simple to simulate, usually a cuboid. Conditions on the density for this to be achievable depend on the value of a non-negative tuning parameter <span class="math inline">\(r\)</span> and are given in <span class="citation">Wakefield, Gelfand, and Smith (1991)</span>. If a density has heavy tails then it may not be possible to form the bounding cuboid if <span class="math inline">\(r\)</span> is too small. In <em>rust</em> <span class="math inline">\(r = 1/2\)</span> is used as a default because it is optimal for a Gaussian density, but a larger value, such as <span class="math inline">\(r = 1\)</span> or greater may be needed if the density has heavy tails. Alternatively, a transformation of variable can be used to ensure the validity of the method and/or improve the efficiency of the algorithm. See the <em>Introducing rust: Ratio-of-Uniforms Simulation with Transformation</em> vignette of the <em>rust</em> package for details. These strategies (increasing <span class="math inline">\(r\)</span> or transformation of variable) are illustrated in the vignette <a href="bang-anova-vignette.html">Hierarchical 1-way Analysis of Variance</a></p>
<p>Only in some simple special cases is it possible to find algebraically the dimensions of the smallest possible bounding cuboid. In practice, these dimensions are found using optimization methods. The first stage is to find the mode of the target density, after which the density is relocated so that its mode is at the origin. This simple strategy will tend to increase the efficiency of the method <span class="citation">(Wakefield, Gelfand, and Smith 1991)</span>. This also makes the search for the remaining dimensions of the bounding cuboid more reliable as does the target density being unimodal. Unimodality of the density is not a necessary condition for the ratio-of-uniforms algorithm to be applicable but a lack of local modes does mean that the numerical optimizations should find the correct bounding cuboid.</p>
<p>Direct simulation methods like the ratio-of-uniforms methods will not replace MCMC as a general method for simulating from posterior densities. However, they may provide a useful alternative for some commonly-used models.</p>
</div>
<div id="an-example-hierarchical-beta-binomial-model" class="section level2">
<h2 class="hasAnchor">
<a href="#an-example-hierarchical-beta-binomial-model" class="anchor"></a>An example: hierarchical beta-binomial model</h2>
<p>As a brief example we use the analysis of the `rat tumor’ data presented in Section 5.3 of <span class="citation">Gelman et al. (2014)</span> based on a hierarchical binomial-beta model. This example is considered in more detail in the vignette <a href="bang-hef-vignette.html">Conjugate Hierarchical Models</a>. The following code reproduces (up to a shift in origin) the content of Figure 5.3 of <span class="citation">Gelman et al. (2014)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(bang)
<span class="co"># To produce a plot akin to Figure 5.3 of Gelman et al. (2014) we</span>
<span class="co"># (a) Use the same prior for (alpha, beta)</span>
<span class="co"># (b) Don't use axis rotation (rotate = FALSE)</span>
<span class="co"># (c) Plot on the scale used for ratio-of-uniforms sampling (ru_scale = TRUE)</span>
<span class="co"># (d) Note that the mode is relocated to (0, 0) in the plot</span>
rat_res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/hef.html">hef</a></span>(<span class="dt">model =</span> <span class="st">"beta_binom"</span>, <span class="dt">data =</span> rat, <span class="dt">rotate =</span> <span class="ot">FALSE</span>, <span class="dt">n =</span> <span class="dv">10000</span>)
<span class="co"># Plot of simulated values and posterior density contours</span>
<span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(rat_res, <span class="dt">ru_scale =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="bang-a-vignette_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The estimated posterior mode, which agrees with Figure 5.3 of Gelman et al. (2014)</span>
rat_res<span class="op">$</span>f_mode
<span class="co">#&gt; [1] -1.785783  2.741549</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references">
<div id="ref-BDA2014">
<p>Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D. B. Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. Florida, USA: Chapman &amp; Hall / CRC. <a href="http://www.stat.columbia.edu/~gelman/book/" class="uri">http://www.stat.columbia.edu/~gelman/book/</a>.</p>
</div>
<div id="ref-revdbayes">
<p>Northrop, P. J. 2017a. <em>Revdbayes: Ratio-of-Uniforms Sampling for Bayesian Extreme Value Analysis</em>. <a href="https://CRAN.R-project.org/package=revdbayes" class="uri">https://CRAN.R-project.org/package=revdbayes</a>.</p>
</div>
<div id="ref-rust">
<p>———. 2017b. <em>rust: Ratio-of-Uniforms Simulation with Transformation</em>. <a href="https://CRAN.R-project.org/package=rust" class="uri">https://CRAN.R-project.org/package=rust</a>.</p>
</div>
<div id="ref-WGS1991">
<p>Wakefield, J. C., A. E. Gelfand, and A. F. M. Smith. 1991. “Efficient Generation of Random Variates via the Ratio-of-Uniforms Method.” <em>Statistics and Computing</em> 1 (2): 129–33. doi:<a href="https://doi.org/10.1007/BF01889987">10.1007/BF01889987</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#the-generalized-ratio-of-uniforms-method-as-an-alternative-to-mcmc">The generalized ratio-of-uniforms method as an alternative to MCMC</a></li>
      <li><a href="#an-example-hierarchical-beta-binomial-model">An example: hierarchical beta-binomial model</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Paul J. Northrop, Benjamin D. Hall.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
