<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introducing bang: Bayesian Analysis, No Gibbs • bang</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introducing bang: Bayesian Analysis, No Gibbs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bang</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bang-a-vignette.html">Introducing bang: Bayesian Analysis, No Gibbs</a></li>
    <li><a class="dropdown-item" href="../articles/bang-b-hef-vignette.html">Conjugate Hierarchical Models</a></li>
    <li><a class="dropdown-item" href="../articles/bang-c-anova-vignette.html">Hierarchical 1-way Analysis of Variance</a></li>
    <li><a class="dropdown-item" href="../articles/bang-d-ppc-vignette.html">Posterior Predictive Checking</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/bang/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introducing bang: Bayesian Analysis, No Gibbs</h1>
                        <h4 data-toc-skip class="author">Paul
Northrop</h4>
            
            <h4 data-toc-skip class="date">2025-11-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paulnorthrop/bang/blob/HEAD/vignettes/bang-a-vignette.Rmd"><code>vignettes/bang-a-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>bang-a-vignette.Rmd</code></div>
    </div>

    
    
<p>The <em>bang</em> package uses the <em>rust</em> package <span class="citation">(Northrop 2017b)</span> to produce random samples,
using the generalized ratio-of-uniforms method, from the posterior
distributions involved in certain Bayesian models. <em>rust</em> was
originally created to perform this role in the package
<em>revdbayes</em> <span class="citation">(Northrop 2017a)</span>, which
deals with basic extreme value models with only 2 or 3 parameters. The
aim of <em>bang</em> is to tackle further models.</p>
<p>See also the vignettes <a href="bang-c-anova-vignette.html">Hierarchical 1-way Analysis of
Variance</a> and <a href="bang-b-hef-vignette.html">Conjugate
Hierarchical Models</a>.</p>
<div class="section level2">
<h2 id="the-generalized-ratio-of-uniforms-method-as-an-alternative-to-mcmc">The generalized ratio-of-uniforms method as an alternative to
MCMC<a class="anchor" aria-label="anchor" href="#the-generalized-ratio-of-uniforms-method-as-an-alternative-to-mcmc"></a>
</h2>
<p>The ratio-of-uniforms method is an acceptance-rejection type
algorithm whose efficiency decreases quickly as the dimension of the
target distribution increases. Therefore, it may not be a feasible
method of sampling directly from a distribution with the order of 10
parameters. However, for some models it is possible to factorize the
joint posterior density into a product of a marginal posterior density
for a low-dimensional set of parameters and conditional posteriors
densities of the other parameters given the parameters in this set. In
such cases we can sample values from the marginal posterior and then
sample from the conditional posteriors given these values. The examples
considered in the first release of <em>bang</em> are hierarchical models
in which the marginal density is not of a simple form (so we use
<em>rust</em> to sample from it) but the conditional densities are of a
simple form and we can simulate from them using standard simulation
algorithms.</p>
<p>In comparison to sampling from a posterior distribution using a
Markov Chain Monte Carlo (MCMC) method, such as Gibbs sampling, direct
simulation to produce a random sample has some advantages: no need to
monitor convergence, no serial dependence in the sample. However, the
generalized ratio-of-uniforms method can only be applied to densities
for which its acceptance region can be enclosed within a bounding region
of finite volume from which it is simple to simulate, usually a cuboid.
Conditions on the density for this to be achievable depend on the value
of a non-negative tuning parameter <span class="math inline">\(r\)</span> and are given in <span class="citation">Wakefield, Gelfand, and Smith (1991)</span>. If a
density has heavy tails then it may not be possible to form the bounding
cuboid if <span class="math inline">\(r\)</span> is too small. In
<em>rust</em> <span class="math inline">\(r = 1/2\)</span> is used as a
default because it is optimal for a Gaussian density, but a larger
value, such as <span class="math inline">\(r = 1\)</span> or greater may
be needed if the density has heavy tails. Alternatively, a
transformation of variable can be used to ensure the validity of the
method and/or improve the efficiency of the algorithm. See the
<em>Introducing rust: Ratio-of-Uniforms Simulation with
Transformation</em> vignette of the <em>rust</em> package for details.
These strategies (increasing <span class="math inline">\(r\)</span> or
transformation of variable) are illustrated in the vignette <a href="bang-c-anova-vignette.html">Hierarchical 1-way Analysis of
Variance</a></p>
<p>Only in some simple special cases is it possible to find
algebraically the dimensions of the smallest possible bounding cuboid.
In practice, these dimensions are found using optimization methods. The
first stage is to find the mode of the target density, after which the
density is relocated so that its mode is at the origin. This simple
strategy will tend to increase the efficiency of the method <span class="citation">(Wakefield, Gelfand, and Smith 1991)</span>. This also
makes the search for the remaining dimensions of the bounding cuboid
more reliable as does the target density being unimodal. Unimodality of
the density is not a necessary condition for the ratio-of-uniforms
algorithm to be applicable but a lack of local modes does mean that the
numerical optimizations should find the correct bounding cuboid.</p>
<p>Direct simulation methods like the ratio-of-uniforms methods will not
replace MCMC as a general method for simulating from posterior
densities. However, they may provide a useful alternative for some
commonly-used models.</p>
</div>
<div class="section level2">
<h2 id="an-example-hierarchical-beta-binomial-model">An example: hierarchical beta-binomial model<a class="anchor" aria-label="anchor" href="#an-example-hierarchical-beta-binomial-model"></a>
</h2>
<p>As a brief example we use the analysis of the `rat tumor’ data
presented in Section 5.3 of <span class="citation">Gelman et al.
(2014)</span> based on a hierarchical binomial-beta model. This example
is considered in more detail in the vignette <a href="bang-b-hef-vignette.html">Conjugate Hierarchical Models</a>. The
following code reproduces (up to a shift in origin) the content of
Figure 5.3 of <span class="citation">Gelman et al. (2014)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/bang/" class="external-link">bang</a></span><span class="op">)</span></span>
<span><span class="co"># To produce a plot akin to Figure 5.3 of Gelman et al. (2014) we</span></span>
<span><span class="co"># (a) Use the same prior for (alpha, beta)</span></span>
<span><span class="co"># (b) Don't use axis rotation (rotate = FALSE)</span></span>
<span><span class="co"># (c) Plot on the scale used for ratio-of-uniforms sampling (ru_scale = TRUE)</span></span>
<span><span class="co"># (d) Note that the mode is relocated to (0, 0) in the plot</span></span>
<span><span class="va">rat_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hef.html">hef</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"beta_binom"</span>, data <span class="op">=</span> <span class="va">rat</span>, rotate <span class="op">=</span> <span class="cn">FALSE</span>, n <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="co"># Plot of simulated values and posterior density contours</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rat_res</span>, ru_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bang-a-vignette_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The estimated posterior mode, which agrees with Figure 5.3 of Gelman et al. (2014)</span></span>
<span><span class="va">rat_res</span><span class="op">$</span><span class="va">f_mode</span></span>
<span><span class="co">#&gt; [1] -1.785783  2.741549</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-BDA2014" class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D.
B. Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. Florida, USA:
Chapman &amp; Hall / CRC. <a href="http://www.stat.columbia.edu/~gelman/book/" class="external-link">http://www.stat.columbia.edu/~gelman/book/</a>.
</div>
<div id="ref-revdbayes" class="csl-entry">
Northrop, P. J. 2017a. <em>Revdbayes: Ratio-of-Uniforms Sampling for
Bayesian Extreme Value Analysis</em>. <a href="https://CRAN.R-project.org/package=revdbayes" class="external-link">https://CRAN.R-project.org/package=revdbayes</a>.
</div>
<div id="ref-rust" class="csl-entry">
———. 2017b. <em><span class="nocase">r</span>ust: Ratio-of-Uniforms
Simulation with Transformation</em>. <a href="https://CRAN.R-project.org/package=rust" class="external-link">https://CRAN.R-project.org/package=rust</a>.
</div>
<div id="ref-WGS1991" class="csl-entry">
Wakefield, J. C., A. E. Gelfand, and A. F. M. Smith. 1991.
<span>“Efficient Generation of Random Variates via the Ratio-of-Uniforms
Method.”</span> <em>Statistics and Computing</em> 1 (2): 129–33. <a href="https://doi.org/10.1007/BF01889987" class="external-link">https://doi.org/10.1007/BF01889987</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop, Benjamin D. Hall.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
