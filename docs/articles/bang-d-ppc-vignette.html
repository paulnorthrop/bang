<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Posterior Predictive Checking â€¢ bang</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Posterior Predictive Checking">
<meta property="og:description" content="bang">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bang</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bang-a-vignette.html">Introducing bang: Bayesian Analysis, No Gibbs</a>
    </li>
    <li>
      <a href="../articles/bang-b-hef-vignette.html">Conjugate Hierarchical Models</a>
    </li>
    <li>
      <a href="../articles/bang-c-anova-vignette.html">Hierarchical 1-way Analysis of Variance</a>
    </li>
    <li>
      <a href="../articles/bang-d-ppc-vignette.html">Posterior Predictive Checking</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/paulnorthrop/bang/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Posterior Predictive Checking</h1>
                        <h4 data-toc-skip class="author">Paul J. Northrop</h4>
            
            <h4 data-toc-skip class="date">2022-04-11</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/paulnorthrop/bang/blob/HEAD/vignettes/bang-d-ppc-vignette.Rmd" class="external-link"><code>vignettes/bang-d-ppc-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>bang-d-ppc-vignette.Rmd</code></div>

    </div>

    
    
<p>This short vignette illustrates the use of the <code>pp_check</code> method <code>pp_check.hef</code>, which provides an interface to the posterior predictive checking graphics in the <em>bayesplot</em> package <span class="citation">(Gabry and Mahr 2017)</span>. For details see the bayesplot vignette <a href="https://CRAN.R-project.org/package=bayesplot" class="external-link">Graphical posterior predictive checks</a>. and/or Chapter 6 of <span class="citation">Gelman et al. (2014)</span>. <em>bayesplot</em> functions return a <code>ggplot</code> object that can be customised using the <em>gglot2</em> package <span class="citation">(Wickham 2016)</span>.</p>
<p>We revisit the examples presented in the vignettes <a href="bang-c-anova-vignette.html">Hierarchical 1-way Analysis of Variance</a> and <a href="bang-b-hef-vignette.html">Conjugate Hierarchical Models</a>. In the code below <code>hef</code> and <code>hanova1</code> have been called with the extra argument <code>nrep = 50</code>. This results in 50 simulated replicates of the data, returned in <code>object$data_rep</code>, on which posterior predictive checking can be based. The general idea is that if the model fits well then the observed data should not appear unusual when compared to replicates from the posterior predictive distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/bang/" class="external-link">bang</a></span><span class="op">)</span>
<span class="co"># Beta-binomial rat tumor example</span>
<span class="va">rat_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hef.html">hef</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"beta_binom"</span>, data <span class="op">=</span> <span class="va">rat</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="co"># Gamma-Poisson pump failure example</span>
<span class="va">pump_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hef.html">hef</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"gamma_pois"</span>, data <span class="op">=</span> <span class="va">pump</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="co"># 1-way Hierarchical ANOVA global warming example</span>
<span class="va">RCP26_2</span> <span class="op">&lt;-</span> <span class="va">temp2</span><span class="op">[</span><span class="va">temp2</span><span class="op">$</span><span class="va">RCP</span> <span class="op">==</span> <span class="st">"rcp26"</span>, <span class="op">]</span>
<span class="va">temp_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hanova1.html">hanova1</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">RCP26_2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, fac <span class="op">=</span> <span class="va">RCP26_2</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, nrep <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<p>We show some examples of the graphical posterior predictive checks that are available from <em>bayesplot</em>, but make no comments on their content. The commented lines above the calls to <code>pp_check</code> describe briefly the type of plot produced.</p>
<div class="section level2">
<h2 id="beta-binomial-model">Beta-binomial model<a class="anchor" aria-label="anchor" href="#beta-binomial-model"></a>
</h2>
<p>The aspect of the data that appears in these plots is the proportion of successful trials.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span>
<span class="co">#&gt; This is bayesplot version 1.8.1</span>
<span class="co">#&gt; - Online documentation and vignettes at mc-stan.org/bayesplot</span>
<span class="co">#&gt; - bayesplot theme set to bayesplot::theme_default()</span>
<span class="co">#&gt;    * Does _not_ affect other ggplot2 plots</span>
<span class="co">#&gt;    * See ?bayesplot_theme_set for details on theme setting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="co"># Overlaid density estimates</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">rat_res</span><span class="op">)</span>
<span class="co"># Overlaid distribution function estimates</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">rat_res</span>, fun <span class="op">=</span> <span class="st">"ecdf_overlay"</span><span class="op">)</span></code></pre></div>
<p><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-3-1.png" width="331.2"><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-3-2.png" width="331.2"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Multiple histograms</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">rat_res</span>, fun <span class="op">=</span> <span class="st">"hist"</span>, nrep <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co"># Multiple boxplots</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">rat_res</span>, fun <span class="op">=</span> <span class="st">"boxplot"</span><span class="op">)</span></code></pre></div>
<p><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-4-1.png" width="672"><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-4-2.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Predictive medians vs observed median</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">rat_res</span>, fun <span class="op">=</span> <span class="st">"stat"</span>, stat <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co"># Predictive (mean, sd) vs observed (mean, sd)</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">rat_res</span>, fun <span class="op">=</span> <span class="st">"stat_2d"</span>, stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-5-1.png" width="672"><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-5-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="gamma-poisson-model">Gamma-Poisson model<a class="anchor" aria-label="anchor" href="#gamma-poisson-model"></a>
</h2>
<p>The aspect of the data that appears in these plots is the exposure-adjusted rate <span class="math inline">\(y_j / e_j\)</span>, where <span class="math inline">\(y_j\)</span> is the observed count and <span class="math inline">\(e_j\)</span> a measure of exposure. See the <a href="bang-b-hef-vignette.html">Conjugate Hierarchical Models</a> vignette for more detail.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Overlaid density estimates</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">pump_res</span><span class="op">)</span>
<span class="co"># Predictive (mean, sd) vs observed (mean, sd)</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">pump_res</span>, fun <span class="op">=</span> <span class="st">"stat_2d"</span>, stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-6-1.png" width="672"><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="one-way-hierarchical-anova">One-way Hierarchical ANOVA<a class="anchor" aria-label="anchor" href="#one-way-hierarchical-anova"></a>
</h2>
<p>The raw responses appear in these plots.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Overlaid density estimates</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">temp_res</span><span class="op">)</span>
<span class="co"># Predictive (mean, sd) vs observed (mean, sd)</span>
<span class="fu"><a href="../reference/pp_check.hef.html">pp_check</a></span><span class="op">(</span><span class="va">temp_res</span>, fun <span class="op">=</span> <span class="st">"stat_2d"</span>, stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-7-1.png" width="672"><img src="bang-d-ppc-vignette_files/figure-html/unnamed-chunk-7-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script><div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bayesplot" class="csl-entry">
Gabry, Jonah, and Tristan Mahr. 2017. <em>Bayesplot: Plotting for Bayesian Models</em>. <a href="https://CRAN.R-project.org/package=bayesplot" class="external-link">https://CRAN.R-project.org/package=bayesplot</a>.
</div>
<div id="ref-BDA2014" class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D. B. Rubin. 2014. <em>Bayesian Data Analysis</em>. Third. Florida, USA: Chapman &amp; Hall / CRC. <a href="http://www.stat.columbia.edu/~gelman/book/" class="external-link">http://www.stat.columbia.edu/~gelman/book/</a>.
</div>
<div id="ref-ggplot2" class="csl-entry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="external-link">https://ggplot2.tidyverse.org</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul J. Northrop, Benjamin D. Hall.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
