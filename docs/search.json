[{"path":"https://github.com/paulnorthrop/bang/articles/bang-a-vignette.html","id":"the-generalized-ratio-of-uniforms-method-as-an-alternative-to-mcmc","dir":"Articles","previous_headings":"","what":"The generalized ratio-of-uniforms method as an alternative to MCMC","title":"Introducing bang: Bayesian Analysis, No Gibbs","text":"ratio--uniforms method acceptance-rejection type algorithm whose efficiency decreases quickly dimension target distribution increases. Therefore, may feasible method sampling directly distribution order 10 parameters. However, models possible factorize joint posterior density product marginal posterior density low-dimensional set parameters conditional posteriors densities parameters given parameters set. cases can sample values marginal posterior sample conditional posteriors given values. examples considered first release bang hierarchical models marginal density simple form (use rust sample ) conditional densities simple form can simulate using standard simulation algorithms. comparison sampling posterior distribution using Markov Chain Monte Carlo (MCMC) method, Gibbs sampling, direct simulation produce random sample advantages: need monitor convergence, serial dependence sample. However, generalized ratio--uniforms method can applied densities acceptance region can enclosed within bounding region finite volume simple simulate, usually cuboid. Conditions density achievable depend value non-negative tuning parameter \\(r\\) given Wakefield, Gelfand, Smith (1991). density heavy tails may possible form bounding cuboid \\(r\\) small. rust \\(r = 1/2\\) used default optimal Gaussian density, larger value, \\(r = 1\\) greater may needed density heavy tails. Alternatively, transformation variable can used ensure validity method /improve efficiency algorithm. See Introducing rust: Ratio--Uniforms Simulation Transformation vignette rust package details. strategies (increasing \\(r\\) transformation variable) illustrated vignette Hierarchical 1-way Analysis Variance simple special cases possible find algebraically dimensions smallest possible bounding cuboid. practice, dimensions found using optimization methods. first stage find mode target density, density relocated mode origin. simple strategy tend increase efficiency method (Wakefield, Gelfand, Smith 1991). also makes search remaining dimensions bounding cuboid reliable target density unimodal. Unimodality density necessary condition ratio--uniforms algorithm applicable lack local modes mean numerical optimizations find correct bounding cuboid. Direct simulation methods like ratio--uniforms methods replace MCMC general method simulating posterior densities. However, may provide useful alternative commonly-used models.","code":""},{"path":"https://github.com/paulnorthrop/bang/articles/bang-a-vignette.html","id":"an-example-hierarchical-beta-binomial-model","dir":"Articles","previous_headings":"","what":"An example: hierarchical beta-binomial model","title":"Introducing bang: Bayesian Analysis, No Gibbs","text":"brief example use analysis `rat tumor’ data presented Section 5.3 Gelman et al. (2014) based hierarchical binomial-beta model. example considered detail vignette Conjugate Hierarchical Models. following code reproduces (shift origin) content Figure 5.3 Gelman et al. (2014).","code":"library(bang) # To produce a plot akin to Figure 5.3 of Gelman et al. (2014) we # (a) Use the same prior for (alpha, beta) # (b) Don't use axis rotation (rotate = FALSE) # (c) Plot on the scale used for ratio-of-uniforms sampling (ru_scale = TRUE) # (d) Note that the mode is relocated to (0, 0) in the plot rat_res <- hef(model = \"beta_binom\", data = rat, rotate = FALSE, n = 10000) # Plot of simulated values and posterior density contours plot(rat_res, ru_scale = TRUE) # The estimated posterior mode, which agrees with Figure 5.3 of Gelman et al. (2014) rat_res$f_mode #> [1] -1.785783  2.741549"},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/articles/bang-b-hef-vignette.html","id":"beta-binomial-model","dir":"Articles","previous_headings":"","what":"Beta-binomial model","title":"Conjugate Hierarchical Models","text":"consider example presented Section 5.3 Gelman et al. (2014), data (Tarone 1982) matrix rat analysed. data contain information experiment , 71 groups rats, total number rats group numbers rats develop tumor recorded, \\(J = 71\\). Conditional \\(\\boldsymbol{\\mathbf{\\theta}} = (\\theta_1, \\ldots, \\theta_J) = (p_1, \\ldots, p_J)\\) assume independent binomial distributions \\((Y_1, \\ldots, Y_J)\\), , \\(Y_j \\sim {\\rm binomial}(n_j, p_j)\\). use conditionally conjugate priors \\(p_j \\sim {\\rm Beta}(\\alpha, \\beta)\\), \\(\\phi = (\\alpha, \\beta)\\). conditional conjagacy priors means marginal posterior \\((\\alpha, \\beta)\\) given \\(\\boldsymbol{\\mathbf{y}} = (y_1, \\ldots, y_J)\\) can determined (equation (5.8) Gelman et al. (2014)) \\[ \\pi(\\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}}) \\propto \\pi(\\alpha, \\beta) \\prod_{j=1}^J \\frac{B(\\alpha + y_j, \\beta + n_j - y_j)}{B(\\alpha, \\beta)}, \\] \\(\\pi(\\alpha, \\beta)\\) hyperprior density \\((\\alpha, \\beta)\\). default \\(\\phi = (\\alpha, \\beta)\\) transformed prior sampling using \\((\\rho_1, \\rho_2)=(\\log (\\alpha/\\beta), \\log (\\alpha+\\beta))\\). aim improve efficiency rotating scaling (mode-relocated) conditional posterior density attempt produce near circularity density’s contours. simulate full posterior density \\(\\pi(\\boldsymbol{\\mathbf{\\theta}}, \\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}}) = \\pi(\\boldsymbol{\\mathbf{\\theta}} \\mid \\alpha, \\beta, \\boldsymbol{\\mathbf{y}}) \\pi(\\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}})\\) first sample \\(\\pi(\\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}})\\). Simulation conditional posterior distribution \\(\\boldsymbol{\\mathbf{\\theta}}\\) given \\((\\alpha, \\beta, \\boldsymbol{\\mathbf{y}})\\) straightforward noting \\[ \\theta_j \\mid \\alpha, \\beta, y_j \\sim {\\rm beta}(\\alpha + y_j, \\beta + n_j - y_j) \\] \\(\\theta_j, j = 1, \\ldots, J\\) conditionally independent. hyperprior \\((\\alpha, \\beta)\\) used default hef \\(\\pi(\\alpha, \\beta) \\propto (\\alpha+\\beta)^{-5/2}, \\alpha>0, \\beta>0\\), following Section 5.3 Gelman et al. (2014). user-defined prior may set using set_user_prior.  plot left shows values sampled posterior distribution \\((\\alpha, \\beta)\\) superimposed density contours. right similar plot displayed scale used sampling, , \\((\\rho_1, \\rho_2)\\). following summary properties generalized ratio-uniforms algorithm, particular probability acceptance, summary statistics posterior sample \\((\\alpha, \\beta)\\).","code":"library(bang) # Default prior, sampling on (rotated) (logit(mean), log(alpha + beta)) scale rat_res <- hef(model = \"beta_binom\", data = rat, n = 10000) plot(rat_res) plot(rat_res, ru_scale = TRUE) summary(rat_res) #> ru bounding box:   #>                box       vals1       vals2 conv #> a        1.0000000  0.00000000  0.00000000    0 #> b1minus -0.2382163 -0.40313465 -0.03906169    0 #> b2minus -0.2174510  0.05447431 -0.35297538    0 #> b1plus   0.2231876  0.36718395 -0.06551365    0 #> b2plus   0.2512577  0.05665707  0.44459818    0 #>  #> estimated probability of acceptance:   #> [1] 0.5258729 #>  #> sample summary  #>      alpha              beta        #>  Min.   : 0.6152   Min.   : 3.883   #>  1st Qu.: 1.7895   1st Qu.:10.675   #>  Median : 2.2198   Median :13.329   #>  Mean   : 2.4050   Mean   :14.341   #>  3rd Qu.: 2.8034   3rd Qu.:16.830   #>  Max.   :14.1474   Max.   :80.895"},{"path":"https://github.com/paulnorthrop/bang/articles/bang-b-hef-vignette.html","id":"gamma-poisson-model","dir":"Articles","previous_headings":"","what":"Gamma-Poisson Model","title":"Conjugate Hierarchical Models","text":"perform fully Bayesian analysis empirical Bayesian example presented Section 4.2 Gelfand Smith (1990), fix hyperparameter \\(\\alpha\\) described point estimate derived data. pump dataset (Gaver O’Muircheartaigh 1987) matrix row gives information one 10 different pump systems. first column contains number pump failures. second column contains length operating time, thousands hours. general setup similar beta-binomial model described now response distribution taken Poisson, prior distribution gamma \\(J = 10\\). \\(j = 1, \\ldots, J\\) let \\(Y_j\\) denote number failures \\(e_j\\) length operating time pump system \\(j\\). Conditional \\(\\boldsymbol{\\mathbf{\\lambda}} = (\\lambda_1, \\ldots, \\lambda_J)\\) assume independent Poisson distributions \\((Y_1, \\ldots, Y_J)\\) means proportional exposure time \\(e_j\\), , \\(Y_j \\sim {\\rm Poisson}(e_j \\lambda_j)\\). use conditionally conjugate priors \\(\\lambda_j \\sim {\\rm gamma}(\\alpha, \\beta)\\), \\(\\phi = (\\alpha, \\beta)\\). use parameterization \\(\\beta\\) rate parameter, \\({\\rm E}(\\lambda_j) = \\alpha/\\beta\\) priori. marginal posterior \\((\\alpha, \\beta)\\) given \\(\\boldsymbol{\\mathbf{y}} = (y_1, \\ldots, y_J)\\) can determined \\[ \\pi(\\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}}) \\propto \\pi(\\alpha, \\beta) \\prod_{j=1}^J \\frac{\\beta^\\alpha\\Gamma(\\alpha + y_j)}{(\\beta+e_j)^{\\alpha+y_j} \\Gamma(\\alpha)}, \\] \\(\\pi(\\alpha, \\beta)\\) hyperprior density \\((\\alpha, \\beta)\\). scale used sampling \\((\\rho_1, \\rho_2)=(\\log (\\alpha/\\beta), \\log \\beta))\\). simulate full posterior \\(\\pi(\\boldsymbol{\\mathbf{\\lambda}}, \\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}}) = \\pi(\\boldsymbol{\\mathbf{\\lambda}} \\mid \\alpha, \\beta, \\boldsymbol{\\mathbf{y}}) \\pi(\\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}})\\) first sample \\(\\pi(\\alpha, \\beta \\mid \\boldsymbol{\\mathbf{y}})\\) note \\[ \\lambda_j \\mid \\alpha, \\beta, y_j \\sim {\\rm gamma}(\\alpha + y_j, \\beta + e_j) \\] \\(\\lambda_j, j = 1, \\ldots, J\\) conditionally independent. default hef takes \\(\\alpha\\) \\(\\beta\\) independent gamma random variables priori. parameters gamma distributions can set user, using argument hpars different prior may set using set_user_prior. produce similar output beta-binomial example .","code":"pump #>       failures    time #>  [1,]        5  94.320 #>  [2,]        1  15.720 #>  [3,]        5  62.880 #>  [4,]       14 125.760 #>  [5,]        3   5.240 #>  [6,]       19  31.440 #>  [7,]        1   1.048 #>  [8,]        1   1.048 #>  [9,]        4   2.096 #> [10,]       22  10.480 pump_res <- hef(model = \"gamma_pois\", data = pump, hpars = c(1, 0.01, 1, 0.01)) plot(pump_res) plot(pump_res, ru_scale = TRUE) summary(pump_res) #> ru bounding box:   #>                box       vals1       vals2 conv #> a        1.0000000  0.00000000  0.00000000    0 #> b1minus -0.5174980 -0.91869101 -0.06060116    0 #> b2minus -0.5150835  0.15757254 -0.92429417    0 #> b1plus   0.4124640  0.65433383 -0.11046433    0 #> b2plus   0.4224941  0.08788857  0.67847965    0 #>  #> estimated probability of acceptance:   #> [1] 0.5094244 #>  #> sample summary  #>      alpha             beta         #>  Min.   :0.2007   Min.   :0.08544   #>  1st Qu.:0.8185   1st Qu.:1.29559   #>  Median :1.0598   Median :1.94558   #>  Mean   :1.1496   Mean   :2.16025   #>  3rd Qu.:1.3915   3rd Qu.:2.73560   #>  Max.   :3.6629   Max.   :9.28544"},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/articles/bang-c-anova-vignette.html","id":"late-21st-century-global-temperature-projection-data","dir":"Articles","previous_headings":"","what":"Late 21st Century Global Temperature Projection Data","title":"Hierarchical 1-way Analysis of Variance","text":"data frame temp2 contains indices global temperature change late 20th century (1970-1999) late 21st century (2069-2098) based data produced Fifth Coupled Model Intercomparison Project (CMIP5). dataset union four subsets, based different greenhouse gas emissions scenario called Representative Concentration Pathway (RCP). analyse data RCP2.6. course, inferences overall temperature change parameter \\(\\mu\\) important, also interesting compare magnitudes \\(\\sigma_\\alpha\\) \\(\\sigma\\). , example, \\(\\sigma_\\alpha\\) much greater \\(\\sigma\\) uncertainty temperature projection associated choice GCM greater associated choice simulation run particular GCM. See Northrop Chandler (2014) information. 61 observations total distributed rather unevenly across 38 GCMs. 28 GCMs least one run available RCP2.6. use hanova1 sample posterior distribution parameters based (default) improper uniform prior \\((\\mu, \\log\\sigma_\\alpha, \\sigma)\\), described Section 11.6 Gelman et al. (2014). prior fits special case considered Appendix, infinite prior variance \\(\\sigma_0^2\\) \\(\\mu\\).  plot left shows values sampled posterior distribution \\((\\sigma_\\alpha, \\sigma)\\) superimposed density contours. see posterior distribution located values \\(\\sigma_\\alpha\\) much greater \\(\\sigma\\), factor nearly 10. right similar plot displayed scale used sampling, \\((\\rho_1, \\rho_2)=(\\log \\sigma_\\alpha, \\log \\sigma)\\), relocation posterior mode origin rotation scaling near circularity density contours. summarize marginal posterior distribution \\(\\mu\\) using histogram superimposed kernel density estimate.  following plot summarizes estimated marginal posterior densities mean index GCM.","code":"library(bang) # Extract RCP2.6 data RCP26_2 <- temp2[temp2$RCP == \"rcp26\", ] # Number of observations length(RCP26_2[, \"index\"]) #> [1] 61 # Numbers of runs for each GCM table(RCP26_2[, \"GCM\"]) #>  #>      ACCESS1-0      ACCESS1-3     bcc-csm1-1   bcc-csm1-1-m        BNU-ESM  #>              0              0              1              1              1  #>        CanESM2          CCSM4      CESM1-BGC     CESM1-CAM5        CMCC-CM  #>              5              6              0              3              0  #>       CMCC-CMS       CNRM-CM5  CSIRO-Mk3-6-0       EC-EARTH      FGOALS-g2  #>              0              1             10              2              1  #>        FIO-ESM       GFDL-CM3     GFDL-ESM2G     GFDL-ESM2M      GISS-E2-H  #>              3              1              1              1              1  #>   GISS-E2-H-CC      GISS-E2-R   GISS-E2-R-CC     HadGEM2-AO     HadGEM2-CC  #>              0              1              0              1              0  #>     HadGEM2-ES         inmcm4   IPSL-CM5A-LR   IPSL-CM5A-MR   IPSL-CM5B-LR  #>              4              0              4              1              0  #>      MIROC-ESM MIROC-ESM-CHEM         MIROC5     MPI-ESM-LR     MPI-ESM-MR  #>              1              1              3              3              1  #>      MRI-CGCM3      NorESM1-M     NorESM1-ME  #>              1              1              1 # Number of GCMs with at least one run sum(table(RCP26_2[, \"GCM\"]) > 0) #> [1] 28 # The response is the index, the explanatory factor is the GCM temp_res <- hanova1(resp = RCP26_2[, \"index\"], fac = RCP26_2[, \"GCM\"]) # Plots relating to the posterior sample of the variance parameters plot(temp_res, params = \"ru\") plot(temp_res, ru_scale = TRUE) hist(temp_res$sim_vals[, \"mu\"],  main = \"\", xlab = expression(mu), prob = TRUE) lines(density(temp_res$sim_vals[, \"mu\"])) plot(temp_res, params = \"pop\", which_pop = \"all\", one_plot = TRUE)"},{"path":"https://github.com/paulnorthrop/bang/articles/bang-c-anova-vignette.html","id":"coagulation-time-data","dir":"Articles","previous_headings":"","what":"Coagulation time data","title":"Hierarchical 1-way Analysis of Variance","text":"temperature projection example sampling conducted scale \\((\\log\\sigma_\\alpha, \\log\\alpha)\\) unproblematic. also unproblematic sampled original \\((\\sigma_\\alpha, \\sigma)\\) scale. show examples latter case consider small dataset presented Section 11.6 Gelman et al. (2014). response variable coagulation time blood drawn 24 animals allocated different diets. crucial aspect dataset explanatory factor (diet) 4 levels. means little information \\(\\sigma_\\alpha\\) data. Unless prior information \\(\\sigma_\\alpha\\) provided posterior distribution \\(\\sigma_\\alpha\\) tend heavy upper tail (Gelman 2006). generalized ratio--uniforms method used rust can fail heavy-tailed densities indeed case data try sample directly \\(\\pi(\\sigma_\\alpha, \\sigma \\mid \\boldsymbol{\\mathbf{y}})\\) using rust package’s default settings generalized ratio--uniforms algorithm. One solution reparameterize \\((\\log\\sigma_\\alpha, \\log\\sigma)\\), hanova1 implements default. Another possibility increase generalized ratio--uniforms tuning parameter r default value 1/2 used rust. approaches illustrated .  heaviness upper tail marginal posterior density \\(\\sigma_\\alpha\\) evident plot left. Parameter transformation \\((\\rho_1, \\rho_2)=(\\log\\sigma_\\alpha, \\log\\sigma)\\) results density (plot right) easier simulate. produce summaries posterior sample stored coag1. summaries calculated coag2 similar. posterior summaries similar presented Table 11.3 Gelman et al. (2014) (\\(\\sigma_\\alpha\\) denoted \\(\\tau\\)), obtained using Gibbs sampling. number groups small Gelman (2006) advocates use half-Cauchy prior \\(\\sigma_\\alpha\\). code implements using independent half-Cauchy priors \\(\\sigma_\\alpha\\) \\(\\sigma\\), , \\[ \\pi(\\sigma_\\alpha, \\sigma) \\propto \\left(1 + \\frac{\\sigma_\\alpha^2}{A_\\alpha^2}\\right)^{-1} \\left(1 + \\frac{\\sigma^2}{^2}\\right)^{-1}, \\quad \\sigma_\\alpha>0, \\, \\sigma>0. \\] choose, somewhat arbitrarily, \\(\\sigma_\\alpha = 10\\): practice \\(\\sigma_\\alpha\\) set considering problem hand. See Gelman (2006) details. set \\(\\) large enough result effectively flat prior \\(\\sigma\\).","code":"coag1 <- hanova1(resp = coagulation[, 1], fac = coagulation[, 2], n = 10000) coag2 <- hanova1(resp = coagulation[, 1], fac = coagulation[, 2], n = 10000,                  param = \"original\", r = 1) plot(coag1, params = \"ru\") plot(coag1, ru_scale = TRUE) probs <- c(2.5, 25, 50, 75, 97.5) / 100 all1 <- cbind(coag1$theta_sim_vals, coag1$sim_vals) round(t(apply(all1, 2, quantile, probs = probs)), 1) #>              2.5%  25%  50%  75% 97.5% #> theta[1]     58.8 60.4 61.2 62.0  63.8 #> theta[2]     64.0 65.2 65.9 66.5  67.9 #> theta[3]     65.7 67.1 67.8 68.4  69.8 #> theta[4]     59.4 60.5 61.1 61.7  62.9 #> mu           54.7 62.2 64.0 65.7  73.2 #> sigma[alpha]  2.0  3.5  5.0  7.9  27.0 #> sigma         1.8  2.2  2.4  2.7   3.4 coag3 <- hanova1(resp = coagulation[, 1], fac = coagulation[, 2],                  param = \"original\", prior = \"cauchy\", hpars = c(10, 1e6))"},{"path":"https://github.com/paulnorthrop/bang/articles/bang-c-anova-vignette.html","id":"appendix","dir":"Articles","previous_headings":"","what":"Appendix","title":"Hierarchical 1-way Analysis of Variance","text":"Consider hierarchical 1-way ANOVA model \\[\\begin{equation*} Y_{ij} = \\mu + \\alpha_i + \\epsilon_{ij}, \\quad\\mbox{} \\,\\, = 1, \\ldots, , \\, j = 1, \\ldots, n_i,  \\label{eqn:1way} \\end{equation*}\\] \\(\\alpha_i \\sim N(0, \\sigma_\\alpha^2)\\) \\(\\epsilon_{ij} \\sim N(0, \\sigma^2)\\) random variables independent. specify prior density \\(\\pi(\\boldsymbol{\\mathbf{\\phi}})\\) \\(\\boldsymbol{\\mathbf{\\phi}} = (\\mu, \\sigma_\\alpha, \\sigma)\\). Let \\(\\boldsymbol{\\mathbf{y}} = \\{y_{ij}, =1, \\ldots, , j = 1, \\ldots, n_i\\}\\) \\(\\boldsymbol{\\mathbf{\\alpha}} = (\\alpha_1, \\ldots, \\alpha_I)\\).","code":""},{"path":"https://github.com/paulnorthrop/bang/articles/bang-c-anova-vignette.html","id":"marginal-posterior-density-of-boldsymbolmathbfphi","dir":"Articles","previous_headings":"Appendix","what":"Marginal posterior density of \\(\\boldsymbol{\\mathbf{\\phi}}\\)","title":"Hierarchical 1-way Analysis of Variance","text":"joint posterior density \\((\\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\mathbf{\\alpha}})\\) satisfies \\[\\begin{align*} \\pi(\\boldsymbol{\\mathbf{\\alpha}},\\boldsymbol{\\mathbf{\\phi}} \\mid \\boldsymbol{\\mathbf{y}}) &\\propto \\pi(\\boldsymbol{\\mathbf{\\phi}}) \\prod\\limits_{=1}^{}\\prod\\limits_{j=1}^{n_i} \\sigma^{-1} \\exp \\left[-\\frac{1}{2\\sigma^2}(y_{ij} - \\mu - \\alpha_i)^2\\right] \\prod_{=1}^{} \\sigma_\\alpha^{-1} \\exp\\left[-\\frac{1}{2\\sigma^2_\\alpha}\\alpha_i^2\\right]  \\nonumber \\\\ &= \\pi(\\boldsymbol{\\mathbf{\\phi}}) \\, \\sigma^{-n_\\cdot} \\, \\sigma_\\alpha^{-} \\prod_{=1}^\\exp \\left\\{ -\\frac12 \\left[ \\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\mu - \\alpha_i)^2 +\\sigma_\\alpha^{-2} \\alpha_i^2 \\right] \\right\\}, \\label{eqn:joint} \\end{align*}\\] \\(n_\\cdot = \\sum_{=1}^{} n_i\\). Let \\(\\bar{y}_{\\cdot} = (1/n_i) \\sum_{j=1}^{n_i} y_{ij}\\). Completing  square \\(\\alpha_i\\) term square brackets gives \\[\\begin{align*} &\\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\mu - \\alpha_i)^2 + \\sigma_\\alpha^{-2} \\alpha_i^2 \\\\ &= \\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\mu)^2 - 2 n_i \\sigma^{-2} (\\bar{y}_{\\cdot} - \\mu) \\alpha_i + (n_i \\sigma^{-2} + \\sigma_\\alpha^{-2})\\alpha_i^2 \\\\ &= (\\sigma^{-2} n_i + \\sigma_{\\alpha}^{-2}) \\left[ \\alpha_i - \\frac{n_i \\sigma^{-2} (\\bar{y}_{\\cdot} - \\mu)}{n_i \\sigma^{-2} + \\sigma_{\\alpha}^{-2}} \\right]^2 - \\frac{n_i^2 \\sigma^{-4} (\\bar{y}_{\\cdot} - \\mu)^2}{n_i \\sigma^{-2} + \\sigma_{\\alpha}^{-2}} + \\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\mu)^2 \\\\ &= a_i (\\alpha_i - b_i / a_i)^2 + c_i - b_i^2 / a_i, \\end{align*}\\] \\(a_i = n_i \\sigma^{-2} + \\sigma_\\alpha^{-2}, b_i = n_i \\sigma^{-2} (\\bar{y}_{\\cdot} - \\mu)\\) \\(c_i = \\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\mu)^2\\). Therefore, \\[\\begin{align*} \\pi(\\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\mathbf{\\alpha}} \\mid \\boldsymbol{\\mathbf{y}}) &\\propto \\pi(\\boldsymbol{\\mathbf{\\phi}}) \\, \\sigma^{-n_\\cdot} \\, \\sigma_\\alpha^{-} \\prod_{=1}^\\exp\\left[ -\\frac12 \\left( c_i - b_i ^ 2 / a_i \\right) \\right] \\exp\\left[ -\\frac{1}{2a_i^{-1}} \\left( \\alpha_i - b_i / a_i \\right)^2 \\right]. \\\\ \\end{align*}\\] marginal posterior density \\(\\boldsymbol{\\mathbf{\\phi}}\\) given \\[\\begin{align*} \\pi(\\boldsymbol{\\mathbf{\\phi}} \\mid \\boldsymbol{\\mathbf{y}}) &= \\int_{-\\infty}^{\\infty}\\cdots\\int_{-\\infty}^{\\infty} \\pi(\\boldsymbol{\\mathbf{\\alpha}}, \\boldsymbol{\\mathbf{\\phi}} \\mid \\boldsymbol{\\mathbf{y}}) {\\rm ~d}\\alpha_1 \\cdots {\\rm ~d}\\alpha_I \\\\ &\\propto \\pi(\\boldsymbol{\\mathbf{\\phi}}) \\, \\sigma^{-n_\\cdot} \\, \\sigma_\\alpha^{-} \\prod_{=1}^\\exp\\left[ -\\frac12 \\left( c_i - b_i ^ 2 / a_i \\right) \\right] \\int_{-\\infty}^{\\infty} \\exp\\left[ -\\frac{1}{2a_i^{-1}} \\left( \\alpha_i - b_i / a_i \\right)^2 \\right] {\\rm ~d}\\alpha_i \\\\ &\\propto \\pi(\\boldsymbol{\\mathbf{\\phi}}) \\, \\sigma^{-n_\\cdot} \\, \\sigma_\\alpha^{-} \\prod_{=1}^a_i^{-1/2} \\exp\\left[ -\\frac12 \\left( c_i - b_i ^ 2 / a_i \\right) \\right] \\\\ &\\propto \\pi(\\boldsymbol{\\mathbf{\\phi}}) \\, \\sigma^{-n_\\cdot} \\, \\prod_{=1}^(\\sigma_\\alpha^2+\\sigma^2/n_i)^{-1/2} \\exp\\left[ -\\frac12 \\left( c_i - b_i ^2 / a_i \\right) \\right]. \\end{align*}\\] Manipulating \\(c_i - b_i ^2 / a_i\\) gives \\[\\begin{align*} c_i - b_i ^ 2 / a_i   &= \\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\mu)^2    - \\frac{n_i^2 \\sigma^{-4} (\\bar{y}_{\\cdot} - \\mu)^2}   {n_i \\sigma^{-2} + \\sigma_\\alpha^{-2}} \\\\   &= \\sigma^{-2} \\left[ \\sum_{j=1}^{n_i} (y_{ij} - \\bar{y}_{\\cdot})^2    + n_i (\\bar{y}_{\\cdot} - \\mu)^2 \\right]    - \\frac{n_i^2 \\sigma^{-4} (\\bar{y}_{\\cdot} - \\mu)^2}   {n_i \\sigma^{-2} + \\sigma_\\alpha^{-2}} \\\\   &= \\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\bar{y}_{\\cdot})^2 +    \\frac{\\left[ n_i \\sigma^{-2} \\left(n_i \\sigma^{-2}+\\sigma_\\alpha^{-2}\\right)     - n_i^2 \\sigma^{-4} \\right]}{n_i \\sigma^{-2} + \\sigma_\\alpha^{-2}}     (\\bar{y}_{\\cdot} - \\mu)^2 \\\\   &= \\sigma^{-2} \\sum_{j=1}^{n_i} (y_{ij} - \\bar{y}_{\\cdot})^2    + \\frac{1}{\\sigma_\\alpha^2 + \\sigma^2 / n_i} (\\mu - \\bar{y}_{\\cdot})^2. \\end{align*}\\] Therefore, joint posterior density \\(\\boldsymbol{\\mathbf{\\phi}}\\) satisfies \\[\\begin{align*} \\pi(\\boldsymbol{\\mathbf{\\phi}} \\mid \\boldsymbol{\\mathbf{y}}) &\\propto \\pi(\\boldsymbol{\\mathbf{\\phi}}) \\, \\sigma^{-n_\\cdot} \\, \\exp\\left( -\\frac{1}{2\\sigma^{2}} S \\right) \\prod_{=1}^\\sigma_i^{-1} \\exp\\left[ -\\frac{1}{2 \\sigma_i^2} (\\mu - \\mu_i)^2 \\right], \\end{align*}\\] \\(S = \\sum_{=1}^\\sum_{j=1}^{n_i} (y_{ij} - \\bar{y}_{\\cdot})^2\\), \\(\\mu_i = \\bar{y}_{\\cdot}\\) \\(\\sigma_i^2 = \\sigma_\\alpha^2 + \\sigma^2/n_i\\).","code":""},{"path":"https://github.com/paulnorthrop/bang/articles/bang-c-anova-vignette.html","id":"a-special-case","dir":"Articles","previous_headings":"Appendix > Marginal posterior density of \\(\\boldsymbol{\\mathbf{\\phi}}\\)","what":"A special case","title":"Hierarchical 1-way Analysis of Variance","text":"Suppose \\(N(\\mu_0, \\sigma_0^2\\)) prior distribution specified \\(\\mu\\), \\(\\pi(\\mu) \\propto \\exp[-\\sigma_0^{-2}(\\mu-\\mu_0)^2) / 2]\\) \\(\\mu\\) \\((\\sigma_\\alpha, \\sigma)\\) independent priori. derive marginal posterior density \\((\\sigma_\\alpha, \\sigma)\\) case conditional posterior density \\(\\mu\\) given \\((\\sigma_\\alpha, \\sigma)\\). joint posterior density \\((\\mu, \\sigma_\\alpha, \\sigma)\\) satisfies \\[\\begin{align*} \\pi(\\mu, \\sigma_\\alpha, \\sigma \\mid \\boldsymbol{\\mathbf{y}}) &\\propto \\pi(\\mu) \\, \\pi(\\sigma_\\alpha, \\sigma) \\, \\sigma^{-n_\\cdot} \\, \\exp\\left( -\\frac{1}{2\\sigma^{2}} S \\right) \\prod_{=1}^\\sigma_i^{-1} \\exp\\left[ -\\frac{1}{2 \\sigma_i^2} (\\mu - \\mu_i)^2 \\right], \\\\ &= \\pi(\\sigma_\\alpha, \\sigma) \\, \\sigma^{-n_\\cdot} \\, \\exp\\left( -\\frac{1}{2\\sigma^{2}} S \\right) \\left(\\prod_{=1}^\\sigma_i^{-1} \\right) \\exp\\left[ -\\frac{1}{2} \\sum_{=0}^{} \\sigma_i^{-2} (\\mu - \\mu_i)^2 \\right], \\end{align*}\\] Completing square \\(\\mu\\) \\(\\sum_{=0}^{} \\sigma_i^{-2} (\\mu - \\mu_i)^2\\) gives \\[\\begin{align*} \\sum_{=0}^{} \\sigma_i^{-2} (\\mu - \\mu_i)^2 &= \\sum_{=0}^{} \\sigma_i^{-2} (\\mu^2 - 2 \\mu \\mu_i + \\mu_i^2) \\\\ &= \\mu^2 \\sum_{=0}^{} \\sigma_i^{-2} - 2 \\mu \\sum_{=0}^{} \\mu_i \\sigma_i^{-2} + \\sum_{=0}^{} \\mu_i ^2 \\sigma_i^{-2} \\\\ &= \\left(\\sum_{=0}^{} \\sigma_i^{-2} \\right) \\left( \\mu - \\frac{\\sum_{=0}^{} \\mu_i \\sigma_i^{-2}} {\\sum_{=0}^{} \\sigma_i^{-2}} \\right)^{\\!\\!2} - \\frac{\\left( \\sum_{=0}^{} \\mu_i \\sigma_i^{-2} \\right)^2} {\\sum_{=0}^{} \\sigma_i^{-2}} + \\sum_{=0}^{} \\mu_i^{2} \\sigma_i^{-2} \\\\ &= S_0 (\\mu - S_1 S_0^{-1})^2 - S_1^2 S_0^{-1} + S_2, \\\\ \\end{align*}\\] \\(S_j = \\sum_{=0}^{} \\mu_i^{j} \\sigma_i^{-2}, \\, j = 0, 1, 2\\). Therefore, \\[\\begin{align*} \\pi(\\sigma_\\alpha, \\sigma \\mid \\boldsymbol{\\mathbf{y}}) &= \\int_{-\\infty}^{\\infty} \\pi(\\mu, \\sigma_\\alpha, \\sigma \\mid \\boldsymbol{\\mathbf{y}}) {\\rm ~d}\\mu \\\\ &\\propto \\pi(\\sigma_\\alpha, \\sigma) \\, \\sigma^{-n_\\cdot} \\, \\exp\\left\\{ -\\frac{1}{2\\sigma^{2}} S \\right\\} \\left(\\prod_{=1}^\\sigma_i^{-1} \\right) \\exp\\left( \\frac12 S_1^2 S_0^{-1} - \\frac12 S_2 \\right) \\\\ &\\phantom{\\propto} \\times \\int_{-\\infty}^{\\infty} \\exp\\left\\{ -\\frac{1}{2 S_0^{-1}} (\\mu - S_1 S_0^{-1})^2 \\right\\} {\\rm ~d}\\mu \\\\ &\\propto \\pi(\\sigma_\\alpha, \\sigma) \\, \\sigma^{-n_\\cdot} \\, \\exp\\left\\{ -\\frac{1}{2\\sigma^{2}} S \\right\\} \\left(\\prod_{=1}^\\sigma_i^{-1} \\right) \\exp\\left( \\frac12 S_1^2 S_0^{-1} - \\frac12 S_2 \\right) S_0^{-1/2}. \\end{align*}\\] Retaining terms \\(\\pi(\\mu, \\sigma_\\alpha, \\sigma \\mid \\boldsymbol{\\mathbf{y}})\\) involve \\(\\mu\\) gives \\[\\begin{align*} \\pi(\\mu \\mid \\sigma_\\alpha, \\sigma, \\boldsymbol{\\mathbf{y}}) &\\propto \\exp\\left[ -\\frac{1}{2 S_0^{-1}} (\\mu - S_1 / S_0)^2 \\right]. \\end{align*}\\] Therefore, \\(\\mu \\mid \\sigma_\\alpha, \\sigma, \\boldsymbol{\\mathbf{y}} \\sim N(S_1 S_0^{-1}, S_0^{-1})\\).","code":""},{"path":"https://github.com/paulnorthrop/bang/articles/bang-c-anova-vignette.html","id":"the-conditional-posterior-density-of-boldsymbolmathbftheta-given-boldsymbolmathbfphi","dir":"Articles","previous_headings":"Appendix","what":"The conditional posterior density of \\(\\boldsymbol{\\mathbf{\\theta}}\\) given \\(\\boldsymbol{\\mathbf{\\phi}}\\)","title":"Hierarchical 1-way Analysis of Variance","text":"conditional posterior density \\(\\boldsymbol{\\mathbf{\\alpha}}\\) given \\(\\boldsymbol{\\mathbf{\\phi}}\\) satisfies \\[\\begin{align*} \\pi(\\boldsymbol{\\mathbf{\\alpha}} \\mid \\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\boldsymbol{\\mathbf{y}}}) &\\propto \\prod_{=1}^\\exp\\left[ -\\frac{1}{2a_i^{-1}} \\left( \\alpha_i - b_i / a_i \\right)^2 \\right], \\end{align*}\\] terms \\(\\pi (\\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\mathbf{\\alpha}} \\mid \\boldsymbol{\\mathbf{y}})\\) involve \\(\\alpha_i, = 1, \\ldots, \\). Therefore, conditional \\(\\boldsymbol{\\mathbf{\\phi}}\\), \\(\\alpha_1, \\ldots, \\alpha_I\\) independent posteriori \\(\\alpha_i \\mid \\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\mathbf{y}} \\sim N(b_i a_i^{-1}, a_i^{-1})\\), \\[\\begin{align*} b_i a_i^{-1} &= \\frac{\\sigma_\\alpha^2 \\, (\\bar{y}_{\\cdot} - \\mu)} {\\sigma_\\alpha^{2} + \\sigma^2 / n_i} \\\\ a_i^{-1} &= \\frac{\\sigma_\\alpha^2 \\, \\sigma^2 / n_i} {\\sigma_\\alpha^{2} + \\sigma^2 / n_i}. \\\\ \\end{align*}\\] Noting \\(\\theta_i = \\mu + \\alpha_i\\) gives \\(\\theta_i \\mid \\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\mathbf{y}} \\sim N(\\hat{\\theta}_i, a_i^{-1})\\), \\[\\begin{align*} \\hat{\\theta}_i &= \\frac{\\bar{y}_{\\cdot} \\sigma_\\alpha^2 + \\mu \\, \\sigma ^ 2 / n_i} {\\sigma_\\alpha^{2} + \\sigma^2 / n_i}. \\\\ \\end{align*}\\]","code":""},{"path":"https://github.com/paulnorthrop/bang/articles/bang-c-anova-vignette.html","id":"factorisations-for-simulation","dir":"Articles","previous_headings":"Appendix","what":"Factorisations for simulation","title":"Hierarchical 1-way Analysis of Variance","text":"general case considered factorisation \\[\\begin{align*} \\pi(\\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\mathbf{\\alpha}} \\mid \\boldsymbol{\\mathbf{y}}) &= \\pi(\\boldsymbol{\\mathbf{\\phi}} \\mid \\boldsymbol{\\mathbf{y}}) \\, \\prod_{=1}^{} \\pi(\\alpha_i \\mid \\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\boldsymbol{\\mathbf{y}}}) \\end{align*}\\] means can simulate first three-dimensional \\(\\pi(\\boldsymbol{\\mathbf{\\phi}}, \\mid \\boldsymbol{\\mathbf{y}})\\) , conditional value \\(\\boldsymbol{\\mathbf{\\phi}}\\), simulate independently normal distributions \\(\\alpha_i \\mid \\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\boldsymbol{\\mathbf{y}}}\\). special case detailed factorisation becomes \\[\\begin{align*} \\pi(\\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\mathbf{\\alpha}} \\mid \\boldsymbol{\\mathbf{y}}) &= \\pi(\\sigma_\\alpha, \\sigma \\mid \\boldsymbol{\\mathbf{y}}) \\, \\pi(\\mu \\mid \\sigma_\\alpha, \\sigma, \\boldsymbol{\\mathbf{y}}) \\, \\prod_{=1}^{} \\pi(\\alpha_i \\mid \\boldsymbol{\\mathbf{\\phi}}, \\boldsymbol{\\boldsymbol{\\mathbf{y}}}). \\end{align*}\\] Therefore, first stage can performed simulating two-dimensional \\(\\pi(\\sigma_\\alpha, \\sigma \\mid \\boldsymbol{\\mathbf{y}})\\) , conditional value \\((\\sigma_\\alpha, \\sigma)\\), normal distribution \\(\\mu \\mid \\sigma_\\alpha, \\sigma, \\boldsymbol{\\mathbf{y}}\\).","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/articles/bang-d-ppc-vignette.html","id":"beta-binomial-model","dir":"Articles","previous_headings":"","what":"Beta-binomial model","title":"Posterior Predictive Checking","text":"aspect data appears plots proportion successful trials.","code":"library(bayesplot) #> This is bayesplot version 1.14.0 #> - Online documentation and vignettes at mc-stan.org/bayesplot #> - bayesplot theme set to bayesplot::theme_default() #>    * Does _not_ affect other ggplot2 plots #>    * See ?bayesplot_theme_set for details on theme setting library(ggplot2) # Overlaid density estimates pp_check(rat_res) # Overlaid distribution function estimates pp_check(rat_res, fun = \"ecdf_overlay\") # Multiple histograms pp_check(rat_res, fun = \"hist\", nrep = 8) #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`. # Multiple boxplots pp_check(rat_res, fun = \"boxplot\") # Predictive medians vs observed median pp_check(rat_res, fun = \"stat\", stat = \"median\") #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`. # Predictive (mean, sd) vs observed (mean, sd) pp_check(rat_res, fun = \"stat_2d\", stat = c(\"mean\", \"sd\")) #> Note: in most cases the default test statistic 'mean' is too weak to detect anything of interest."},{"path":"https://github.com/paulnorthrop/bang/articles/bang-d-ppc-vignette.html","id":"gamma-poisson-model","dir":"Articles","previous_headings":"","what":"Gamma-Poisson model","title":"Posterior Predictive Checking","text":"aspect data appears plots exposure-adjusted rate \\(y_j / e_j\\), \\(y_j\\) observed count \\(e_j\\) measure exposure. See Conjugate Hierarchical Models vignette detail.","code":"# Overlaid density estimates pp_check(pump_res) # Predictive (mean, sd) vs observed (mean, sd) pp_check(pump_res, fun = \"stat_2d\", stat = c(\"mean\", \"sd\")) #> Note: in most cases the default test statistic 'mean' is too weak to detect anything of interest."},{"path":"https://github.com/paulnorthrop/bang/articles/bang-d-ppc-vignette.html","id":"one-way-hierarchical-anova","dir":"Articles","previous_headings":"","what":"One-way Hierarchical ANOVA","title":"Posterior Predictive Checking","text":"raw responses appear plots.","code":"# Overlaid density estimates pp_check(temp_res) # Predictive (mean, sd) vs observed (mean, sd) pp_check(temp_res, fun = \"stat_2d\", stat = c(\"mean\", \"sd\")) #> Note: in most cases the default test statistic 'mean' is too weak to detect anything of interest."},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Paul J. Northrop. Author, maintainer, copyright holder. Benjamin D. Hall. Author, copyright holder.","code":""},{"path":"https://github.com/paulnorthrop/bang/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Northrop PJ, Hall BD (2025). bang: Bayesian Analysis, Gibbs. R package version 1.0.4.9000, https://paulnorthrop.github.io/bang/.","code":"@Manual{,   title = {bang: Bayesian Analysis, No Gibbs},   author = {Paul J. Northrop and Benjamin D. Hall},   year = {2025},   note = {R package version 1.0.4.9000},   url = {https://paulnorthrop.github.io/bang/}, }"},{"path":[]},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/index.html","id":"what-does-bang-do","dir":"","previous_headings":"","what":"What does bang do?","title":"Bayesian Analysis, No Gibbs","text":"Provides functions Bayesian analysis simple commonly-used models, without using Markov Chain Monte Carlo (MCMC) methods Gibbs sampling. ‘rust’ package https://cran.r-project.org/package=rust used simulate random sample required posterior distribution, using ratio--uniforms method. Currently three conjugate hierarchical models available: beta-binomial, gamma-Poisson 1-way Analysis Variance (ANOVA). Advantages ratio--uniforms method MCMC context user required set tuning parameters monitor convergence random posterior sample produced.","code":""},{"path":"https://github.com/paulnorthrop/bang/index.html","id":"a-simple-example","dir":"","previous_headings":"","what":"A simple example","title":"Bayesian Analysis, No Gibbs","text":"hef function samples posterior distribution parameters certain hierarchical exponential family models. following code performs essentially analysis rat tumor data using beta-binomial hierarchical model appears Section 5.3 Gelman, ., Carlin, J. B., Stern, H. S. Dunson, D. B., Vehtari, . Rubin, D. B. (2014) Bayesian Data Analysis. Chapman & Hall / CRC. http://www.stat.columbia.edu/~gelman/book/.","code":"library(bang) rat_res <- hef(model = \"beta_binom\", data = rat) plot(rat_res)"},{"path":"https://github.com/paulnorthrop/bang/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Analysis, No Gibbs","text":"get current released version CRAN:","code":"install.packages(\"bang\")"},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://github.com/paulnorthrop/bang/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://github.com/paulnorthrop/bang/reference/bang-package.html","id":null,"dir":"Reference","previous_headings":"","what":"bang: Bayesian Analysis, No Gibbs — bang-package","title":"bang: Bayesian Analysis, No Gibbs — bang-package","text":"Performs Bayesian analyses using simple commonly-used models. multivariate generalized ratio--uniforms method used simulate random samples required posterior distribution. user can either choose hyperparameter values default prior distribution specify prior distribution.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/bang-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"bang: Bayesian Analysis, No Gibbs — bang-package","text":"Currently three conjugate hierarchical models available: beta-binomial, gamma-Poisson 1-way Analysis Variance (ANOVA). function hef produces random posterior samples beta-binomial gamma-Poisson models.  function hanova1 1-way Analysis Variance (ANOVA). rust package used produce samples. See vignette(\"bang--vignette\", package = \"bang\") brief introduction package vignette(\"bang-b-hef-vignette\", package = \"bang\") vignette(\"bang-c-anova-vignette\", package = \"bang\") illustrations use hef hanova1 functions.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/bang-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"bang: Bayesian Analysis, No Gibbs — bang-package","text":"Northrop, P. J. (2017). rust: Ratio--Uniforms Simulation   Transformation. R package version 1.2.3.   https://cran.r-project.org/package=rust.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/bang-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"bang: Bayesian Analysis, No Gibbs — bang-package","text":"Maintainer: Paul J. Northrop p.northrop@ucl.ac.uk [copyright holder] Authors: Benjamin D. Hall benjamin.hall.16@ucl.ac.uk [copyright holder]","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/coagulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Coagulation time data — coagulation","title":"Coagulation time data — coagulation","text":"Coagulation time seconds blood drawn 24 animals randomly allocated four different diets Box, Hunter, Hunter (1978). data frame coagulation 24 rows 2 columns. row relates different animal. Column 1 contains coagulation times. Column 2 contains label type diet: one , B, C D.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/coagulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coagulation time data — coagulation","text":"","code":"coagulation"},{"path":"https://github.com/paulnorthrop/bang/reference/coagulation.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Coagulation time data — coagulation","text":"data frame 24 rows 2 columns.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/coagulation.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Coagulation time data — coagulation","text":"Table 11.2 Gelman, ., Carlin, J. B., Stern, H. S. Dunson, D. B.,  Vehtari, . Rubin, D. B. (2014) Bayesian Data Analysis.  Chapman & Hall / CRC.   http://www.stat.columbia.edu/~gelman/book/","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/coagulation.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Coagulation time data — coagulation","text":"Box, G. E. P., Hunter, W. G., Hunter, J. S. (1978).   Statistics Experimenters. New York: Wiley.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hanova1.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","title":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","text":"Produces random samples posterior distribution parameters 1-way hierarchical ANOVA model.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hanova1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","text":"","code":"hanova1(   n = 1000,   resp,   fac,   ...,   prior = \"default\",   hpars = NULL,   param = c(\"trans\", \"original\"),   init = NULL,   mu0 = 0,   sigma0 = Inf,   nrep = NULL )"},{"path":"https://github.com/paulnorthrop/bang/reference/hanova1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","text":"n numeric scalar.  size posterior sample required. resp numeric vector.  Response values. fac vector class factor indicating group corresponding element resp originates. Must length resp. ... Optional arguments passed ru. prior log-prior parameters hyperprior distribution.  user wishes specify prior prior must object returned call set_user_prior. Otherwise, prior character scalar giving name required -built prior. prior supplied default prior used. See Details. hpars numeric vector.  Used set parameters () -built prior.  prior = cauchy hpars numeric vector length 2 giving respective scale parameters half-Cauchy priors \\(\\sigma_\\alpha\\) \\(\\sigma\\). param character scalar. param = \"trans\" (default) marginal posterior hyperparameter vector \\(\\phi\\) reparameterized terms \\(log \\sigma_\\alpha, log \\sigma\\). param = \"original\" original parameterization, .e. \\(\\sigma_\\alpha, \\sigma\\) used. former tends make optimizations involved ratio--uniforms algorithm stable increase probability acceptance, expense slower function evaluations. init numeric vector. Optional initial estimates sent ru search mode posterior density (perhaps subset ) hyperparameter vector \\(\\phi\\). -built prior used ru used sample marginal posterior density \\((\\sigma_\\alpha, \\sigma)\\), init must length 2.  Otherwise, init length equal argument anova_d supplied set_user_prior. mu0, sigma0 numeric scalar.  Mean standard deviation normal prior \\(\\mu\\).  used -built prior used anova_d = 2 supplied call set_user_prior set user-defined prior. default, sigma0 = Inf, sets improper uniform prior \\(\\mu\\). nrep numeric scalar.  nrep NULL nrep gives number replications original dataset simulated posterior predictive distribution. replication based one samples posterior distribution.  Therefore, nrep must greater n. event nrep set equal n.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hanova1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","text":"object (list) class \"hef\",   structure object class \"ru\" returned ru.   particular, columns n-row matrix sim_vals   contain simulated values \\(\\phi\\).   addition list contains arguments model, resp,   fac prior detailed n \\(\\)   matrix theta_sim_vals: column \\(\\) contains simulated   values  \\(\\theta\\)\\(\\).  Also included   data = cbind(resp, fac) summary_stats list   containing: number groups ; numbers responses   group ni; total number observations; sample mean   response group; sum squared deviations   group means s; arguments hanova1 mu0   sigma0; call: matched call hanova1.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hanova1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","text":"Consider \\(\\) independent experiments \\(ni\\) responses   \\(y\\)\\(\\) experiment/group \\(\\) normally   distributed mean \\(\\theta \\) standard deviation \\(\\sigma\\).   population parameters \\(\\theta\\)1, ...,   \\(\\theta\\)\\(\\) modelled random samples normal   distribution mean \\(\\mu\\) standard deviation   \\(\\sigma_\\alpha\\).  Let \\(\\phi = (\\mu, \\sigma_\\alpha, \\sigma)\\).   Conditionally \\(\\theta\\)1, ..., \\(\\theta\\)\\(\\),   \\(y\\)1, ..., \\(y\\)\\(\\)   independent independent \\(\\phi\\).   hyperprior placed \\(\\phi\\).   user can either choose parameter values default hyperprior   specify hyperprior using set_user_prior. ru function rust   package used draw random sample marginal posterior   hyperparameter vector \\(\\phi\\).   , conditional values, population parameters sampled   directly conditional posterior density   \\(\\theta\\)1, ..., \\(\\theta\\)\\(\\) given \\(\\phi\\) data.   See vignette(\"bang-c-anova-vignette\", package = \"bang\")   details. following priors specified proportionality. Priors: prior = \"bda\" (default): \\(\\pi(\\mu, \\sigma_\\alpha, \\sigma) = 1/\\sigma,\\) , uniform prior \\((\\mu, \\sigma_\\alpha, log \\sigma)\\), \\(\\sigma_\\alpha > 0\\) \\(\\sigma > 0\\). data must contain least 3 groups, , fac must least 3 levels, proper posterior density obtained. [See Sections 5.7  11.6 Gelman et al. (2014).] prior = \"unif\": \\(\\pi(\\mu, \\sigma_\\alpha, \\sigma) = 1,\\) , uniform prior \\((\\mu, \\sigma_\\alpha, \\sigma)\\), \\(\\sigma_\\alpha > 0\\) \\(\\sigma > 0\\). [See Section 11.6 Gelman et al. (2014).] prior = \"cauchy\": independent half-Cauchy priors \\(\\sigma_\\alpha\\) \\(\\sigma\\) respective scale parameters \\(A_\\alpha\\) \\(\\), , \\(\\pi(\\sigma_\\alpha, \\sigma) =   1 / [(1 + \\sigma_\\alpha^2 / A_\\alpha^2) (1 + \\sigma^2 / ^2)].\\) [See Gelman (2006).]  scale parameters (\\(A_\\alpha\\), \\(\\)) specified using hpars = (\\(A_\\alpha\\), \\(\\)). default setting hpars = c(10, 10). Parameterizations sampling: param = \"original\" (\\(\\mu, \\sigma_\\alpha, \\sigma\\)),  param = \"trans\" (default)   \\(\\phi1 = \\mu, \\phi2 = log \\sigma_\\alpha, \\phi3 = log \\sigma\\).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hanova1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","text":"Gelman, ., Carlin, J. B., Stern, H. S. Dunson, D. B.,  Vehtari, . Rubin, D. B. (2014) Bayesian Data Analysis.  Chapman & Hall / CRC. Gelman, . (2006) Prior distributions variance   parameters hierarchical models. Bayesian Analysis,   1(3), 515-533. doi:10.1214/06-BA117A .","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/hanova1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior sampling for a 1-way hierarchical ANOVA — hanova1","text":"","code":"# ======= Late 21st Century Global Temperature Data =======  # Extract data for RCP2.6 RCP26_2 <- temp2[temp2$RCP == \"rcp26\", ]  # Sample from the posterior under the default `noninformative' flat prior # for (mu, sigma_alpha, log(sigma)).  Ratio-of-uniforms is used to sample # from the marginal posterior for (log(sigma_alpha), log(sigma)). temp_res <- hanova1(resp = RCP26_2[, 1], fac = RCP26_2[, 2])  # Plot of sampled values of (sigma_alpha, sigma) plot(temp_res, params = \"ru\")   # Plot of sampled values of (log(sigma_alpha), log(sigma)) # (centred at (0,0)) plot(temp_res, ru_scale = TRUE)   # Plot of sampled values of (mu, sigma_alpha, sigma) plot(temp_res)   # Estimated marginal posterior densities of the mean for each GCM plot(temp_res, params = \"pop\", which_pop = \"all\", one_plot = TRUE)   # Posterior sample quantiles probs <- c(2.5, 25, 50, 75, 97.5) / 100 round(t(apply(temp_res$sim_vals, 2, quantile, probs = probs)), 2) #>              2.5%  25%  50%  75% 97.5% #> mu           1.07 1.19 1.24 1.29  1.41 #> sigma[alpha] 0.34 0.40 0.44 0.48  0.60 #> sigma        0.04 0.05 0.06 0.06  0.07  # Ratio-of-uniforms information and posterior sample summaries summary(temp_res) #> ru bounding box:   #>                box         vals1        vals2 conv #> a        1.0000000  0.0000000000  0.000000000    0 #> b1minus -0.1466810 -0.2326509989  0.001997344    0 #> b2minus -0.1475368 -0.0004397794 -0.234538810    0 #> b1plus   0.1755008  0.3048045191  0.001126515    0 #> b2plus   0.1739269 -0.0010104521  0.300416382    0 #>  #> estimated probability of acceptance:   #> [1] 0.5353319 #>  #> sample summary  #>        mu         sigma[alpha]        sigma         #>  Min.   :0.928   Min.   :0.3074   Min.   :0.03934   #>  1st Qu.:1.186   1st Qu.:0.3995   1st Qu.:0.05193   #>  Median :1.239   Median :0.4377   Median :0.05589   #>  Mean   :1.239   Mean   :0.4450   Mean   :0.05680   #>  3rd Qu.:1.290   3rd Qu.:0.4824   3rd Qu.:0.06093   #>  Max.   :1.542   Max.   :0.7227   Max.   :0.09106    # ======= Coagulation time data, from Table 11.2 Gelman et al (2014) =======  # With only 4 groups the posterior for sigma_alpha has a heavy right tail if # the default `noninformative' flat prior for (mu, sigma_alpha, log(sigma)) # is used.  If we try to sample from the marginal posterior for # (sigma_alpha, sigma) using the default generalized ratio-of-uniforms # runing parameter value r = 1/2 then the acceptance region is not bounded.  # Two remedies: reparameterize the posterior and/or increase the value of r.  # (log(sigma_alpha), log(sigma)) parameterization, ru parameter r = 1/2 coag1 <- hanova1(resp = coagulation[, 1], fac = coagulation[, 2])  # (sigma_alpha, sigma) parameterization, ru parameter r = 1 coag2 <- hanova1(resp = coagulation[, 1], fac = coagulation[, 2],                param = \"original\", r = 1)  # Values to compare to those in Table 11.3 of Gelman et al (2014) all1 <- cbind(coag1$theta_sim_vals, coag1$sim_vals) all2 <- cbind(coag2$theta_sim_vals, coag2$sim_vals) round(t(apply(all1, 2, quantile, probs = probs)), 1) #>              2.5%  25%  50%  75% 97.5% #> theta[1]     58.7 60.4 61.2 62.0  63.8 #> theta[2]     63.9 65.2 65.8 66.5  67.8 #> theta[3]     65.9 67.1 67.7 68.4  69.7 #> theta[4]     59.5 60.6 61.1 61.7  62.9 #> mu           54.5 62.1 64.1 65.9  75.9 #> sigma[alpha]  1.9  3.7  5.4  8.2  27.3 #> sigma         1.8  2.2  2.4  2.7   3.4 round(t(apply(all2, 2, quantile, probs = probs)), 1) #>              2.5%  25%  50%  75% 97.5% #> theta[1]     58.9 60.5 61.3 62.1  63.7 #> theta[2]     64.0 65.2 65.8 66.6  67.9 #> theta[3]     65.7 67.1 67.7 68.4  69.7 #> theta[4]     59.5 60.5 61.1 61.7  62.9 #> mu           54.1 62.4 64.1 65.7  72.7 #> sigma[alpha]  1.9  3.4  4.9  7.6  28.5 #> sigma         1.8  2.2  2.4  2.7   3.4  # Pairwise plots of posterior samples from the group means plot(coag1, which_pop = \"all\", plot_type = \"pairs\")   # Independent half-Cauchy priors for sigma_alpha and sigma coag3 <- hanova1(resp = coagulation[, 1], fac = coagulation[, 2],                  param = \"original\", prior = \"cauchy\", hpars = c(10, 1e6))"},{"path":"https://github.com/paulnorthrop/bang/reference/hef.html","id":null,"dir":"Reference","previous_headings":"","what":"Hierarchical Exponential Family Model — hef","title":"Hierarchical Exponential Family Model — hef","text":"Produces random samples posterior distribution parameters certain hierarchical exponential family models.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hierarchical Exponential Family Model — hef","text":"","code":"hef(   n = 1000,   model = c(\"beta_binom\", \"gamma_pois\"),   data,   ...,   prior = \"default\",   hpars = NULL,   param = c(\"trans\", \"original\"),   init = NULL,   nrep = NULL )"},{"path":"https://github.com/paulnorthrop/bang/reference/hef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hierarchical Exponential Family Model — hef","text":"n integer scalar.  size posterior sample required. model character string.  Abbreviated name response-population distribution combination. hierarchical normal model see hanova1 (hierarchical one-way analysis variance (ANOVA)). data numeric matrix.  format depends model. See Details. ... Optional arguments passed ru. prior log-prior parameters hyperprior distribution.  user wishes specify prior prior must object returned call set_user_prior. Otherwise, prior character scalar giving name required -built prior. prior supplied default prior used. See Details. hpars numeric vector.  Used set parameters () -built prior. param character scalar. param = \"trans\" (default) marginal posterior hyperparameter vector \\(\\phi\\) reparameterized way designed improve efficiency sampling posterior. param = \"original\" original parameterization used. former tends make optimizations involved ratio--uniforms algorithm stable increase probability acceptance, expense slower function evaluations. init numeric vector length 2.  Optional initial estimates search mode posterior density hyperparameter vector \\(\\phi\\). nrep numeric scalar.  nrep NULL nrep gives number replications original dataset simulated posterior predictive distribution. replication based one samples posterior distribution.  Therefore, nrep must greater n. event nrep set equal n.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hierarchical Exponential Family Model — hef","text":"object (list) class \"hef\",   structure object class \"ru\" returned ru.   particular, columns n-row matrix sim_vals   contain simulated values \\(\\phi\\).   addition list contains arguments model, data   prior detailed , n \\(J\\) matrix   theta_sim_vals: column \\(j\\) contains simulated values   \\(\\theta\\)\\(j\\) call: matched call hef. nrep NULL list also contains   data_rep, numerical matrix nrep columns.   column contains replication first column original   data data[, 1], simulated posterior predictive   distribution.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hef.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Hierarchical Exponential Family Model — hef","text":"Conditional population-specific parameter vectors   \\(\\theta\\)1, ..., \\(\\theta\\)\\(J\\)   observed response data \\(y\\)1, ..., \\(y\\)J within   population modelled random samples distribution   exponential family. population parameters \\(\\theta\\)1, ...,   \\(\\theta\\)\\(J\\) modelled random samples common   population distribution, chosen conditionally conjugate   response distribution, hyperparameter vector   \\(\\phi\\).  Conditionally   \\(\\theta\\)1, ..., \\(\\theta\\)\\(J\\), \\(y\\)1, ..., \\(y\\)\\(J\\)   independent independent \\(\\phi\\).   hyperprior placed \\(\\phi\\).  user can either   choose parameter values default hyperprior specify   hyperprior using set_user_prior. ru function rust   package used draw random sample   marginal posterior hyperparameter vector \\(\\phi\\).   , conditional values, population parameters sampled   directly conditional posterior density   \\(\\theta\\)1, ..., \\(\\theta\\)\\(J\\) given \\(\\phi\\) data. outline model, specify format   data, give default (log-)priors (additive constant)   detail choices ratio--uniforms parameterization   param. Beta-binomial: \\(j = 1, ..., J\\),   \\(Yj | pj\\) ..d binomial\\((nj, pj)\\),   \\(pj\\) probability success group \\(j\\)   \\(nj\\) number trials group \\(j\\).   \\(pj\\) ..d. beta\\((\\alpha, \\beta)\\),   \\(\\phi = (\\alpha, \\beta)\\).   data 2-column matrix: numbers successes column 1   corresponding numbers trials column 2. Priors: prior = \"bda\" (default): \\(log \\pi(\\alpha, \\beta) = - 2.5 log(\\alpha + \\beta),   \\alpha > 0, \\beta > 0.\\) [See Section 5.3 Gelman et al. (2014).] prior = \"gamma\": independent gamma priors \\(\\alpha\\) \\(\\beta\\), .e. \\(log \\pi(\\alpha, \\beta) =   (s1 - 1)log\\alpha - r1 \\alpha +   (s2 - 1)log\\beta - r2 \\beta,  \\alpha > 0, \\beta > 0.\\) respective shape (\\(s1\\), \\(s2\\)) rate (\\(r1\\), \\(r2\\)) parameters specified using hpars = \\((s1, r1, s2, r2)\\).  default setting hpars = c(1, 0.01, 1, 0.01). Parameterizations sampling: param = \"original\" (\\(\\alpha, \\beta\\)),  param = \"trans\" (default) \\(\\phi1 = logit(\\alpha/(\\alpha+\\beta)) = log(\\alpha/\\beta),   \\phi2 = log(\\alpha+\\beta)\\). See Section 5.3 Gelman et al. (2014). Gamma-Poisson: \\(j = 1, ..., J\\),   \\(Yj | \\lambda\\)j ..d Poisson(\\(e\\)j\\(\\lambda\\)j),     \\(ej\\) exposure group \\(j\\), based   total length observation time /size population   risk event interest \\(\\lambda\\)j mean number   events per unit exposure.   \\(\\lambda\\)j ..d. gamma\\((\\alpha, \\beta)\\),   \\(\\phi = (\\alpha, \\beta)\\).   data 2-column matrix: counts \\(yj\\) numbers   events column 1 corresponding exposures \\(ej\\) column 2. Priors: prior = \"gamma\" (default): independent gamma priors   \\(\\alpha\\) \\(\\beta\\), .e. \\(log \\pi(\\alpha, \\beta) =   (s1 - 1)log\\alpha - r1 \\alpha +   (s2 - 1)log\\beta - r2 \\beta,  \\alpha > 0, \\beta > 0.\\) respective shape (\\(s1\\), \\(s2\\)) rate (\\(r1\\), \\(r2\\)) parameters specified using hpars = \\((s1, r1, s2, r2)\\).  default setting hpars = c(1, 0.01, 1, 0.01). Parameterizations sampling: param = \"original\" (\\(\\alpha, \\beta\\)),  param = \"trans\" (default) \\(\\phi1 = log(\\alpha/\\beta), \\phi2 = log(\\beta).\\)","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/hef.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Hierarchical Exponential Family Model — hef","text":"Gelman, ., Carlin, J. B., Stern, H. S. Dunson, D. B.,  Vehtari, . Rubin, D. B. (2014) Bayesian Data Analysis.  Chapman & Hall / CRC.   http://www.stat.columbia.edu/~gelman/book/","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/hef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hierarchical Exponential Family Model — hef","text":"","code":"############################ Beta-binomial #################################  # ------------------------- Rat tumor data ------------------------------- #  # Default prior, sampling on (rotated) (log(mean), log(alpha + beta)) scale rat_res <- hef(model = \"beta_binom\", data = rat) # \\donttest{ # Hyperparameters alpha and beta plot(rat_res)  # Parameterization used for sampling plot(rat_res, ru_scale = TRUE)  # } summary(rat_res) #> ru bounding box:   #>                box       vals1       vals2 conv #> a        1.0000000  0.00000000  0.00000000    0 #> b1minus -0.2382163 -0.40313465 -0.03906169    0 #> b2minus -0.2174510  0.05447431 -0.35297538    0 #> b1plus   0.2231876  0.36718395 -0.06551365    0 #> b2plus   0.2512577  0.05665707  0.44459818    0 #>  #> estimated probability of acceptance:   #> [1] 0.498008 #>  #> sample summary  #>      alpha             beta        #>  Min.   :0.8463   Min.   : 4.044   #>  1st Qu.:1.7965   1st Qu.:10.686   #>  Median :2.2084   Median :13.184   #>  Mean   :2.4042   Mean   :14.320   #>  3rd Qu.:2.7790   3rd Qu.:16.501   #>  Max.   :7.9318   Max.   :50.229    # Choose rats with extreme sample probabilities pops <- c(which.min(rat[, 1] / rat[, 2]), which.max(rat[, 1] / rat[, 2])) # Population-specific posterior samples: separate plots plot(rat_res, params = \"pop\", plot_type = \"both\", which_pop = pops)  # Population-specific posterior samples: one plot plot(rat_res, params = \"pop\", plot_type = \"dens\", which_pop = pops,      one_plot = TRUE, add_legend = TRUE)   # Default prior, sampling on (rotated) (alpha, beta) scale rat_res <- hef(model = \"beta_binom\", data = rat, param = \"original\") # \\donttest{ plot(rat_res)  plot(rat_res, ru_scale = TRUE)  # } summary(rat_res) #> ru bounding box:   #>                box       vals1      vals2 conv #> a        1.0000000  0.00000000  0.0000000    0 #> b1minus -1.0464012 -1.85116847  0.8473716    0 #> b2minus -0.7515215  0.06414713 -1.0929862    0 #> b1plus   1.2453108  2.53614928  1.3267447    0 #> b2plus   1.6246189  0.52814754  3.8051940    0 #>  #> estimated probability of acceptance:   #> [1] 0.5017561 #>  #> sample summary  #>      alpha             beta        #>  Min.   :0.9306   Min.   : 5.493   #>  1st Qu.:1.8073   1st Qu.:10.654   #>  Median :2.2219   Median :13.348   #>  Mean   :2.4151   Mean   :14.444   #>  3rd Qu.:2.8476   3rd Qu.:16.897   #>  Max.   :8.9132   Max.   :51.735    # To produce a plot akin to Figure 5.3 of Gelman et al. (2014) we # (a) Use the same prior for (alpha, beta) # (b) Don't use axis rotation (rotate = FALSE) # (c) Plot on the scale used for ratio-of-uniforms sampling (ru_scale = TRUE) # (d) Note that the mode is relocated to (0, 0) in the plot rat_res <- hef(model = \"beta_binom\", data = rat, rotate = FALSE) # \\donttest{ plot(rat_res, ru_scale = TRUE)  # } # This is the estimated location of the posterior mode rat_res$f_mode #> [1] -1.785783  2.741549  # User-defined prior, passing parameters # (equivalent to prior = \"gamma\" with hpars = c(1, 0.01, 1, 0.01)) user_prior <- function(x, hpars) {   return(dexp(x[1], hpars[1], log = TRUE) + dexp(x[2], hpars[2], log = TRUE)) } user_prior_fn <- set_user_prior(user_prior, hpars = c(0.01, 0.01)) rat_res <- hef(model = \"beta_binom\", data = rat, prior = user_prior_fn) # \\donttest{ plot(rat_res)  # } summary(rat_res) #> ru bounding box:   #>                box       vals1       vals2 conv #> a        1.0000000  0.00000000  0.00000000    0 #> b1minus -0.2425978 -0.41087097 -0.04439263    0 #> b2minus -0.2145118  0.05190271 -0.34376799    0 #> b1plus   0.2280150  0.37607515 -0.07085000    0 #> b2plus   0.2730012  0.06004980  0.51162996    0 #>  #> estimated probability of acceptance:   #> [1] 0.5202914 #>  #> sample summary  #>      alpha             beta        #>  Min.   : 1.034   Min.   : 7.039   #>  1st Qu.: 2.278   1st Qu.:13.733   #>  Median : 2.925   Median :17.434   #>  Mean   : 3.181   Mean   :19.075   #>  3rd Qu.: 3.746   3rd Qu.:22.565   #>  Max.   :10.487   Max.   :57.031    ############################ Gamma-Poisson #################################  # ------------------------ Pump failure data ------------------------------ #  pump_res <- hef(model = \"gamma_pois\", data = pump) # Hyperparameters alpha and beta # \\donttest{ plot(pump_res)  # } # Parameterization used for sampling plot(pump_res, ru_scale = TRUE)  summary(pump_res) #> ru bounding box:   #>                box       vals1       vals2 conv #> a        1.0000000  0.00000000  0.00000000    0 #> b1minus -0.5174980 -0.91869101 -0.06060116    0 #> b2minus -0.5150835  0.15757254 -0.92429417    0 #> b1plus   0.4124640  0.65433383 -0.11046433    0 #> b2plus   0.4224941  0.08788857  0.67847965    0 #>  #> estimated probability of acceptance:   #> [1] 0.5050505 #>  #> sample summary  #>      alpha             beta        #>  Min.   :0.2271   Min.   :0.2641   #>  1st Qu.:0.7898   1st Qu.:1.2480   #>  Median :1.0698   Median :1.8685   #>  Mean   :1.1439   Mean   :2.1614   #>  3rd Qu.:1.4256   3rd Qu.:2.7301   #>  Max.   :4.8299   Max.   :8.7179    # Choose pumps with extreme sample rates pops <- c(which.min(pump[, 1] / pump[, 2]), which.max(pump[, 1] / pump[, 2])) plot(pump_res, params = \"pop\", plot_type = \"dens\", which_pop = pops)"},{"path":"https://github.com/paulnorthrop/bang/reference/plot.hef.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics for a hef object — plot.hef","title":"Plot diagnostics for a hef object — plot.hef","text":"plot method class \"hef\".","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/plot.hef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics for a hef object — plot.hef","text":"","code":"# S3 method for class 'hef' plot(   x,   y,   ...,   params = c(\"hyper\", \"ru\", \"pop\"),   which_pop = NULL,   plot_type = NULL,   one_plot = FALSE,   add_legend = FALSE,   legend_position = \"topright\",   legend_text = NULL,   num = 100 )"},{"path":"https://github.com/paulnorthrop/bang/reference/plot.hef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics for a hef object — plot.hef","text":"x object class \"hef\", result call ru. y used. ... Additional arguments passed plot.ru, hist pairs. particular, ru_scale = TRUE produces plot using parameterization used ratio--uniforms sampling. params character scalar determines parameters  plots relate. \"hyper\": posterior sample hyperparameter     values \\(\\phi\\) plotted using plot.ru. \"ru\": posterior sample generated using     ru plotted using plot.ru.     produces different plot params = \"hyper\" ru     used subset \\(\\phi\\).  example, may     case x result call hanova1.     See vignette(\"bang-c-anova-vignette\", package = \"bang\")     information. \"pop\": posterior samples /densities     population-specific parameter \\(\\theta\\) plotted.      population(s) included determined which_pop     type plot determined plot_type.     plot_type supplied set \"dens\". which_pop integer vector character scalar. params = \"pop\" which_pop indicates populations include plot.  which_pop supplied params set \"pop\".  which_pop = \"\" populations included.  many populations may fail plot_type = \"pairs\" /one_plot = FALSE. plot_type character scalar determines type plot  produced params = \"pop\".  plot_type supplied  params set automatically \"pop\". \"sim\": histograms posterior samples     \\(\\theta\\) populations which_pop. \"dens\": estimates marginal posterior     densities \\(\\theta\\) populations which_pop. \"\": histograms estimated posterior densities. \"pairs\": pairwise scatter plots posterior samples     \\(\\theta\\) populations which_pop, must     length greater one. one_plot, add_legend, legend_position, legend_text relevant plot_type = \"dens\".  one_plot = TRUE estimated marginal posterior densities plotted graph add_legend = TRUE legend added plot using legend position indicated character scalar legend_position. character vector legend_text may used override default legend text. num numeric scalar.  plot_type == \"dens\" plot_type == \"\" num gives number points marginal densities evaluated produce plots.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/plot.hef.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot diagnostics for a hef object — plot.hef","text":"See examples hef hanova1.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/pp_check.hef.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior predictive checks for a hef object — pp_check.hef","title":"Posterior predictive checks for a hef object — pp_check.hef","text":"pp_check method class \"hef\".  provides interface functions perform posterior predictive checks bayesplot package.  See PPC-overview details functions.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/pp_check.hef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior predictive checks for a hef object — pp_check.hef","text":"","code":"# S3 method for class 'hef' pp_check(object, fun = NULL, raw = FALSE, nrep = NULL, ...)"},{"path":"https://github.com/paulnorthrop/bang/reference/pp_check.hef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior predictive checks for a hef object — pp_check.hef","text":"object object class \"hef\", result call hef hanova1. fun plotting function call. Can functions detailed PPC-overview. \"ppc_\" prefix can optionally dropped fun specified string. raw relevant object$model = \"beta_binom\" object$model = \"gamma_pois\". raw = TRUE raw responses used plots. Otherwise, proportions successes used beta_binom case exposure-adjusted rate gamma_pois case.  cases values used  object$data[, 1] / object$data[, 2] equivalent  object$data_rep. nrep number predictive replicates use.  nrep supplied first nrep rows object$data_rep used.  Otherwise, nrep greater nrow(object$data_rep), rows used. ... Additional arguments passed bayesplot functions. See Examples .","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/pp_check.hef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior predictive checks for a hef object — pp_check.hef","text":"ggplot object can customized using   ggplot2 package.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/pp_check.hef.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior predictive checks for a hef object — pp_check.hef","text":"details functions see PPC-overview.   See also vignettes   Conjugate Hierarchical Models,   Hierarchical 1-way Analysis Variance   bayesplot vignette   Graphical posterior predictive checks. general idea compare observed data object$data   matrix object$data_rep row   replication observed data simulated posterior predictive   distribution.  greater detail see Chapter 6 Gelman et al. (2013).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/pp_check.hef.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Posterior predictive checks for a hef object — pp_check.hef","text":"Jonah Gabry (2016). bayesplot: Plotting Bayesian Models. R package version 1.1.0. https://CRAN.R-project.org/package=bayesplot Gelman, ., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, ., Rubin, D. B. (2013). Bayesian Data Analysis. Chapman & Hall/CRC Press, London, third edition. (Chapter 6). http://www.stat.columbia.edu/~gelman/book/","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/pp_check.hef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior predictive checks for a hef object — pp_check.hef","text":"","code":"############################ Beta-binomial #################################  # ------------------------- Rat tumor data ------------------------------- #  rat_res <- hef(model = \"beta_binom\", data = rat, nrep = 50)  # Overlaid density estimates pp_check(rat_res)  # \\donttest{ # Overlaid distribution function estimates pp_check(rat_res, fun = \"ecdf_overlay\")  # } # Multiple histograms pp_check(rat_res, fun = \"hist\", nrep = 8) #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`.  # \\donttest{ # Multiple boxplots pp_check(rat_res, fun = \"boxplot\")  # Predictive medians vs observed median pp_check(rat_res, fun = \"stat\", stat = \"median\") #> `stat_bin()` using `bins = 30`. Pick better value `binwidth`.  # } # Predictive (mean, sd) vs observed (mean, sd) pp_check(rat_res, fun = \"stat_2d\", stat = c(\"mean\", \"sd\")) #> Note: in most cases the default test statistic 'mean' is too weak to detect anything of interest.   ############################ Gamma-Poisson #################################  # ------------------------ Pump failure data ------------------------------ #  pump_res <- hef(model = \"gamma_pois\", data = pump, nrep = 50)  # \\donttest{ # Overlaid density estimates pp_check(pump_res)  # Predictive (mean, sd) vs observed (mean, sd) pp_check(pump_res, fun = \"stat_2d\", stat = c(\"mean\", \"sd\")) #> Note: in most cases the default test statistic 'mean' is too weak to detect anything of interest.  # }  ###################### One-way Hierarchical ANOVA ##########################  #----------------- Late 21st Century Global Temperature Data ------------- #  RCP26_2 <- temp2[temp2$RCP == \"rcp26\", ] temp_res <- hanova1(resp = RCP26_2[, 1], fac = RCP26_2[, 2], nrep = 50) # \\donttest{ # Overlaid density estimates pp_check(temp_res)  # Predictive (mean, sd) vs observed (mean, sd) pp_check(temp_res, fun = \"stat_2d\", stat = c(\"mean\", \"sd\")) #> Note: in most cases the default test statistic 'mean' is too weak to detect anything of interest.  # }"},{"path":"https://github.com/paulnorthrop/bang/reference/print.hef.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class ","title":"Print method for objects of class ","text":"print method class \"hef\".","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/print.hef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class ","text":"","code":"# S3 method for class 'hef' print(x, ...)"},{"path":"https://github.com/paulnorthrop/bang/reference/print.hef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class ","text":"x object class \"hef\", result call hef hanova1. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/print.hef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class ","text":"argument x, invisibly, print   methods.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/print.hef.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print method for objects of class ","text":"Prints original call hef   hanova1, name model number populations   hierarchical model.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/print.summary.hef.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class ","title":"Print method for objects of class ","text":"print method class \"summary.hef\".","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/print.summary.hef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class ","text":"","code":"# S3 method for class 'summary.hef' print(x, ...)"},{"path":"https://github.com/paulnorthrop/bang/reference/print.summary.hef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class ","text":"x object class \"summary.hef\", result call summary.hef. ... Additional optional arguments passed print.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/print.summary.hef.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class ","text":"argument x, invisibly, print   methods.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/print.summary.hef.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print method for objects of class ","text":"printed depends argument params supplied   summary.hef.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/pump.html","id":null,"dir":"Reference","previous_headings":"","what":"Pump-failure data — pump","title":"Pump-failure data — pump","text":"Data pump failures Gaver, D. P. O'Muircheartaigh, . G. (1987). matrix pump 10 rows 2 columns. row relates different pump system. first column contains number pump failures. second column contains length operating time, thousands hours.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/pump.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pump-failure data — pump","text":"","code":"pump"},{"path":"https://github.com/paulnorthrop/bang/reference/pump.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pump-failure data — pump","text":"matrix 10 rows 2 columns.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/pump.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Pump-failure data — pump","text":"Table 3 Gaver, D. P. O'Muircheartaigh, . G. (1987).   See also Gelfand, . E. Smith, . F. M. (1990).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/pump.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pump-failure data — pump","text":"Gaver, D. P. O'Muircheartaigh, . G. (1987)   Robust Empirical Bayes Analyses Event Rates. Technometrics,   29, 1-15. doi:10.1080/00401706.1987.10488178 Gelfand, . E. Smith, . F. M. (1990) Sampling-Based Approaches Calculating Marginal Densities. Journal American Statistical Association, 85(410), 398-409. doi:10.1080/01621459.1990.10476213","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/rat.html","id":null,"dir":"Reference","previous_headings":"","what":"Rat tumor data — rat","title":"Rat tumor data — rat","text":"Tumor incidence 71 groups rats: 70 groups Tarone (1982) additional group (last one) Table 5.1 Gelman al (2014). matrix rat 71 rows 2 columns. row relates different group rats. first column (y) contains number rats tumors. second column (n) contains total number rats.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/rat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rat tumor data — rat","text":"","code":"rat"},{"path":"https://github.com/paulnorthrop/bang/reference/rat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Rat tumor data — rat","text":"matrix 71 rows 2 columns.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/rat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Rat tumor data — rat","text":"Table 5.1 Gelman, ., Carlin, J. B., Stern, H. S. Dunson, D. B.,  Vehtari, . Rubin, D. B. (2014) Bayesian Data Analysis,  Chapman & Hall / CRC.   http://www.stat.columbia.edu/~gelman/book/data/rats.asc","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/rat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rat tumor data — rat","text":"Tarone, R. E. (1982) use historical information   testing trend proportions. Biometrics, 38,   215-220. doi:10.2307/2530304","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/set_user_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Set a user-defined prior — set_user_prior","title":"Set a user-defined prior — set_user_prior","text":"Constructs user-defined prior distribution use argument prior hef hanova1.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/set_user_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set a user-defined prior — set_user_prior","text":"","code":"set_user_prior(   prior,   ...,   model = c(\"beta_binom\", \"gamma_pois\", \"anova1\"),   anova_d = 2 )"},{"path":"https://github.com/paulnorthrop/bang/reference/set_user_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set a user-defined prior — set_user_prior","text":"prior R function returning log prior density (perhaps subset ) hyperparameter vector \\(\\phi\\). ... arguments giving names values parameters involved function prior. model character string.  Abbreviated name model: \"beta_binom\" beta-binomial \"gamma_pois\" gamma-Poisson (see hef), \"anova1\" 1-way ANOVA (see hanova1). anova_d integer scalar.  relevant model = anova1. anova_d = 2 prior must return log-prior density standard deviations \\((\\sigma_\\alpha, \\sigma)\\) normal prior mean mu0 standard deviation sigma0 used \\(\\mu\\).  values mu0 = 0 sigma0 = Inf set call hanova1, default values mu0 = 0 sigma0 = Inf. anova_d = 3 prior must return log-prior density \\((\\mu, \\sigma_\\alpha, \\sigma)\\).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/set_user_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set a user-defined prior — set_user_prior","text":"list class \"bang_prior\".  contain component   prior, user-supplied function evaluate log prior,   arguments supplied ....","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/set_user_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set a user-defined prior — set_user_prior","text":"details hyperparameters \\(\\phi\\) see   Details section hef models   beta_binom gamma_pois hanova1   model anova1.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/reference/set_user_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set a user-defined prior — set_user_prior","text":"","code":"# User-defined prior, passing parameters # (equivalent to prior = \"gamma\" with hpars = c(1, 0.01, 1, 0.01)) user_prior <- function(x, hpars) {   return(dexp(x[1], hpars[1], log = TRUE) + dexp(x[2], hpars[2], log = TRUE)) } user_prior_fn <- set_user_prior(user_prior, hpars = c(0.01, 0.01))"},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_beta_binom.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from a beta-binomial posterior predictive distribution — sim_pred_beta_binom","title":"Simulate from a beta-binomial posterior predictive distribution — sim_pred_beta_binom","text":"Simulates nrep draws posterior predictive distribution beta-binomial model described hef. function called within hef argument nrep supplied.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_beta_binom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from a beta-binomial posterior predictive distribution — sim_pred_beta_binom","text":"","code":"sim_pred_beta_binom(theta_sim_vals, data, nrep)"},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_beta_binom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from a beta-binomial posterior predictive distribution — sim_pred_beta_binom","text":"theta_sim_vals numeric matrix nrow(data) columns. row theta_sim_vals contains binomial success probabilities simulated posterior distribution. data 2-column numeric matrix: numbers successes column 1 corresponding numbers trials column 2. nrep numeric scalar.  number replications original dataset simulated posterior predictive distribution. nrep greater nrow(theta_sim_vals) nrep set equal nrow(theta_sim_vals).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_beta_binom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from a beta-binomial posterior predictive distribution — sim_pred_beta_binom","text":"numeric matrix nrep columns.  column contains   draw posterior predictive distribution number   successes.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_beta_binom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate from a beta-binomial posterior predictive distribution — sim_pred_beta_binom","text":"","code":"rat_res <- hef(model = \"beta_binom\", data = rat) rat_sim_pred <- sim_pred_beta_binom(rat_res$theta_sim_vals, rat, 50)"},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_gamma_pois.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from a gamma-Poisson posterior predictive distribution — sim_pred_gamma_pois","title":"Simulate from a gamma-Poisson posterior predictive distribution — sim_pred_gamma_pois","text":"Simulates nrep draws posterior predictive distribution beta-binomial model described hef. function called within hef argument nrep supplied.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_gamma_pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from a gamma-Poisson posterior predictive distribution — sim_pred_gamma_pois","text":"","code":"sim_pred_gamma_pois(theta_sim_vals, data, nrep)"},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_gamma_pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from a gamma-Poisson posterior predictive distribution — sim_pred_gamma_pois","text":"theta_sim_vals numeric matrix nrow(data) columns. row theta_sim_vals contains binomial success probabilities simulated posterior distribution. data 2-column numeric matrix: numbers successes column 1 corresponding numbers trials column 2. nrep numeric scalar.  number replications original dataset simulated posterior predictive distribution. nrep greater nrow(theta_sim_vals) nrep set equal nrow(theta_sim_vals).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_gamma_pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from a gamma-Poisson posterior predictive distribution — sim_pred_gamma_pois","text":"numeric matrix nrep columns.  column contains   draw posterior predictive distribution number   successes.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_gamma_pois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate from a gamma-Poisson posterior predictive distribution — sim_pred_gamma_pois","text":"","code":"pump_res <- hef(model = \"gamma_pois\", data = pump) pump_sim_pred <- sim_pred_gamma_pois(pump_res$theta_sim_vals, pump, 50)"},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_hanova1.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate from a one-way hierarchical ANOVA posterior predictive distribution — sim_pred_hanova1","title":"Simulate from a one-way hierarchical ANOVA posterior predictive distribution — sim_pred_hanova1","text":"Simulates nrep draws posterior predictive distribution one-way hierarchical ANOVA model described hanova1. function called within hanova1 argument nrep supplied.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_hanova1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate from a one-way hierarchical ANOVA posterior predictive distribution — sim_pred_hanova1","text":"","code":"sim_pred_hanova1(theta_sim_vals, sim_vals, fac, nrep)"},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_hanova1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate from a one-way hierarchical ANOVA posterior predictive distribution — sim_pred_hanova1","text":"theta_sim_vals numeric matrix length(fac) columns. row theta_sim_vals contains normal means simulated posterior distribution. sim_vals numeric matrix length(fac) columns. row sim_vals contains normal standard deviations \\(\\sigma\\) simulated posterior distribution. fac argument fac hanova1, , vector class factor indicating group membership. nrep numeric scalar.  number replications original dataset simulated posterior predictive distribution. nrep greater nrow(theta_sim_vals) nrep set equal nrow(theta_sim_vals).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_hanova1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate from a one-way hierarchical ANOVA posterior predictive distribution — sim_pred_hanova1","text":"numeric matrix nrep columns.  column contains   draw posterior predictive distribution number   successes.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/sim_pred_hanova1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate from a one-way hierarchical ANOVA posterior predictive distribution — sim_pred_hanova1","text":"","code":"RCP26_2 <- temp2[temp2$RCP == \"rcp26\", ] temp_res <- hanova1(resp = RCP26_2[, 1], fac = RCP26_2[, 2]) sim_pred <- sim_pred_hanova1(temp_res$theta_sim_vals, temp_res$sim_vals,                              RCP26_2[, 2], 50)"},{"path":"https://github.com/paulnorthrop/bang/reference/summary.hef.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarizing hef objects — summary.hef","title":"Summarizing hef objects — summary.hef","text":"summary method class \"hef\".","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/summary.hef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarizing hef objects — summary.hef","text":"","code":"# S3 method for class 'hef' summary(   object,   ...,   params = c(\"hyper\", \"pop\"),   which_pop = 1:ncol(object$theta_sim_vals) )"},{"path":"https://github.com/paulnorthrop/bang/reference/summary.hef.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarizing hef objects — summary.hef","text":"object object class \"hef\", result call hef. ... Additional arguments passed summary.ru. params character scalar. params = \"hyper\" posterior samples   hyperparameter values \\(\\phi\\) summarized using   summary.ru. params = \"pop\" posterior samples populations   specified which_pop summarized. which_pop integer vector.  params = \"pop\" which_pop indicates populations, .e. columns object$theta_sim_vals summarize, using summary.  default populations.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/summary.hef.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarizing hef objects — summary.hef","text":"","code":"# Beta-binomial model, rat data rat_res <- hef(model = \"beta_binom\", data = rat)  # Posterior summaries of the hyperparameters alpha and beta summary(rat_res) #> ru bounding box:   #>                box       vals1       vals2 conv #> a        1.0000000  0.00000000  0.00000000    0 #> b1minus -0.2382163 -0.40313465 -0.03906169    0 #> b2minus -0.2174510  0.05447431 -0.35297538    0 #> b1plus   0.2231876  0.36718395 -0.06551365    0 #> b2plus   0.2512577  0.05665707  0.44459818    0 #>  #> estimated probability of acceptance:   #> [1] 0.5277045 #>  #> sample summary  #>      alpha              beta        #>  Min.   : 0.8054   Min.   : 4.808   #>  1st Qu.: 1.7388   1st Qu.:10.296   #>  Median : 2.1945   Median :13.099   #>  Mean   : 2.4033   Mean   :14.327   #>  3rd Qu.: 2.8016   3rd Qu.:16.730   #>  Max.   :10.5493   Max.   :55.273    # Posterior summaries of the binomial probability for rats 1 to 3 summary(rat_res, params = \"pop\", which_pop = 1:3) #>       p[1]               p[2]                p[3]           #>  Min.   :0.001522   Min.   :0.0005025   Min.   :0.0003723   #>  1st Qu.:0.031576   1st Qu.:0.0316907   1st Qu.:0.0313851   #>  Median :0.055558   Median :0.0546739   Median :0.0548144   #>  Mean   :0.062533   Mean   :0.0628370   Mean   :0.0631815   #>  3rd Qu.:0.085518   3rd Qu.:0.0865366   3rd Qu.:0.0853328   #>  Max.   :0.246239   Max.   :0.2300442   Max.   :0.2565092"},{"path":"https://github.com/paulnorthrop/bang/reference/temp1.html","id":null,"dir":"Reference","previous_headings":"","what":"Mid 21st Century Global Temperature Projection Data — temp1","title":"Mid 21st Century Global Temperature Projection Data — temp1","text":"Indices global temperature change late 20th century (1970-1999) mid 21st century (2020-2049) based data produced Fifth Coupled Model Intercomparison Project (CMIP5).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mid 21st Century Global Temperature Projection Data — temp1","text":"","code":"temp1"},{"path":"https://github.com/paulnorthrop/bang/reference/temp1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mid 21st Century Global Temperature Projection Data — temp1","text":"data frame 270 rows 4 columns. Column 1, index: anomaly 2020-2049 mean relative       1970-1999 mean. Column 2, GCM: Abbreviated name General Circulation       Model. Column 3, RCP: Representative Concentration Pathway.       One rcp26, rcp45, rcp60, rcp85. Column 4, run: Simulation run number.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp1.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mid 21st Century Global Temperature Projection Data — temp1","text":"raw data indices calculated monthly   CMIP5 scenario runs global surface air temperature (tas)   downloaded KNMI Climate Explorer (https://climexp.knmi.nl/)   4/3/2015.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mid 21st Century Global Temperature Projection Data — temp1","text":"data frame temp1 data frame 270 rows 4 columns. row relates climate projection run one 38 different General Circulation Models (GCMs) particular Representative Concentration Pathway (RCP). Use table(temp1[, c(\"GCM\", \"RCP\")]) see numbers runs RCP GCM. See Van Vuuren et al (2011) overview RCPs Northrop Chandler (2014) analyses similar older dataset (CMIP3). Column 1 contains anomaly mean global temperature time period 2020-2049 relative mean global temperature 1970-1999, .e. latter subtracted former. Column 2 contains abbreviation name climate modelling research group GCM. Column 3 contains RCP format rcpxx xx radiative forcing level resulting anticipated future greenhouse gas emissions. Column 4 simulation run number.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mid 21st Century Global Temperature Projection Data — temp1","text":"Northrop, P.J. R.E. Chandler (2014). Quantifying   Sources Uncertainty Projections Future Climate.   Journal Climate, 27, 8793-8808.   doi:10.1175/JCLI-D-14-00265.1 Van Vuuren, D. P., Edmonds, J., Kainuma, M., Riahi, K.   Thomson, ., Hibbard, K., Hurtt, G. C., Kram, T., Krey, V.,   Lamarque, J.-F. (2011). representative concentration pathways:   overview. Climatic change, 109, 5-31.   doi:10.1007/s10584-011-0148-z","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp2.html","id":null,"dir":"Reference","previous_headings":"","what":"Late 21st Century Global Temperature Projection Data — temp2","title":"Late 21st Century Global Temperature Projection Data — temp2","text":"Indices global temperature change late 20th century (1970-1999) late 21st century (2069-2098) based data produced Fifth Coupled Model Intercomparison Project (CMIP5).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Late 21st Century Global Temperature Projection Data — temp2","text":"","code":"temp2"},{"path":"https://github.com/paulnorthrop/bang/reference/temp2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Late 21st Century Global Temperature Projection Data — temp2","text":"data frame 270 rows 4 columns. Column 1, index: anomaly 2069-2098 mean relative       1970-1999 mean. Column 2, GCM: Abbreviated name General Circulation       Model. Column 3, RCP: Representative Concentration Pathway.       One rcp26, rcp45, rcp60, rcp85. Column 4, run: Simulation run number.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Late 21st Century Global Temperature Projection Data — temp2","text":"raw data indices calculated monthly   CMIP5 scenario runs global surface air temperature (tas)   downloaded KNMI Climate Explorer (https://climexp.knmi.nl/)   4/3/2015.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Late 21st Century Global Temperature Projection Data — temp2","text":"data frame temp2 data frame 270 rows 4 columns. row relates climate projection run one 38 different General Circulation Models (GCMs) particular Representative Concentration Pathway (RCP). Use table(temp2[, c(\"GCM\", \"RCP\")]) see numbers runs RCP GCM. See Van Vuuren et al (2011) overview RCPs Northrop Chandler (2014) analyses similar older dataset (CMIP3). Column 1 contains anomaly mean global temperature time period 2069-2098 relative mean global temperature 1970-1999, .e. latter subtracted former. Column 2 contains abbreviation name climate modelling research group GCM. Column 3 contains RCP format rcpxx xx radiative forcing level resulting anticipated future greenhouse gas emissions. Column 4 simulation run number.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/temp2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Late 21st Century Global Temperature Projection Data — temp2","text":"Northrop, P.J. R.E. Chandler (2014). Quantifying   Sources Uncertainty Projections Future Climate.   Journal Climate, 27, 8793-8808.   doi:10.1175/JCLI-D-14-00265.1 Van Vuuren, D. P., Edmonds, J., Kainuma, M., Riahi, K.   Thomson, ., Hibbard, K., Hurtt, G. C., Kram, T., Krey, V.,   Lamarque, J.-F. (2011). representative concentration pathways:   overview. Climatic change, 109, 5-31.   doi:10.1007/s10584-011-0148-z","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/weight_gain.html","id":null,"dir":"Reference","previous_headings":"","what":"Weight Gained by Rats — weight_gain","title":"Weight Gained by Rats — weight_gain","text":"Data experiment study weight gained 10 rats fed four different diets, defined combination amount protein (low high) source protein (beef cereal).","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/weight_gain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weight Gained by Rats — weight_gain","text":"","code":"weight_gain"},{"path":"https://github.com/paulnorthrop/bang/reference/weight_gain.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Weight Gained by Rats — weight_gain","text":"data frame 40 rows 3 columns. Column 1, source: source protein, factor levels       Beef Cereal. Column 2, type: amount protein, factor levels       High Low. Column 3, weightgain: weight gained, grams.","code":""},{"path":"https://github.com/paulnorthrop/bang/reference/weight_gain.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Weight Gained by Rats — weight_gain","text":"D. J. Hand, . D. Lunn, K. J. McConway, E. Ostrowski (1994).   Handbook Small Datasets, Chapman Hall/CRC, London.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bug-fixes-and-minor-improvements-1-0-4-9000","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"bang 1.0.4.9000","text":"Corrected description rat data help file. Thank Léo Belzile spotting . Issue 3 Corrected log(mean) logit(mean) comment first chunk Beta-binomial section. Thank Chris Williams spotting .","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bang-104","dir":"Changelog","previous_headings":"","what":"bang 1.0.4","title":"bang 1.0.4","text":"CRAN release: 2024-07-17","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bug-fixes-and-minor-improvements-1-0-4","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"bang 1.0.4","text":"Fixed 2  targets missing (rust) package anchors Rd files hanova1() hef().","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bang-103","dir":"Changelog","previous_headings":"","what":"bang 1.0.3","title":"bang 1.0.3","text":"CRAN release: 2023-12-02","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bug-fixes-1-0-3","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bang 1.0.3","text":"Fixed issues incorrect use Rd files.","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bang-102","dir":"Changelog","previous_headings":"","what":"bang 1.0.2","title":"bang 1.0.2","text":"CRAN release: 2023-09-02","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bug-fixes-and-minor-improvements-1-0-2","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"bang 1.0.2","text":"beta_init_ests() initial estimate beta corrected case vp > mp * (1 - mp), vp mp respectively sample variance sample mean input probabilities. Thank Thomas Richardson spotting . Create help file package correctly, alias bang-package. Activated 3rd edition testthat package","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bang-101","dir":"Changelog","previous_headings":"","what":"bang 1.0.1","title":"bang 1.0.1","text":"CRAN release: 2020-02-24","code":""},{"path":"https://github.com/paulnorthrop/bang/news/index.html","id":"bug-fixes-and-minor-improvements-1-0-1","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"bang 1.0.1","text":"pkgdown documentation https://paulnorthrop.github.io/bang/ Added check argument hpars hef() hanova1() valid. Corrected typos vignette Hierarchical 1-way Analysis Variance. 9th line Appendix expression given ndot incorrect. simply sum sample sizes individual groups. subsection “Marginal posterior density phi” Appendix (ci-bi/ai)^2 corrected (ci-bi^2/ai). typo: ultimate expressions correct. summary method class “hef” now set according Section 8.1 R FAQ (https://cran.r-project.org/doc/FAQ/R-FAQ.html). Corrected error meant S3 plot method plot.hef() resetting graphical parameters correctly exit.","code":""}]
